import ee from"./DeleteModal-8d3310ec.js";import{p as te,s as ae,T as se,r as g,U as _,v as le,c as o,o as t,d as r,f as c,h as u,w as s,i as v,g as l,F as C,j as A,ag as ne,m as b,t as m,e as h,I as f,k as T,N as oe,l as re,ai as ce,n as ie}from"./index-1c00fb64.js";import{u as de}from"./Board-9e9cea74.js";import"./favoriteBoards-2c1dc5de.js";const ue={class:"relative"},ve={key:0,class:"flex gap-2 items-center flex-wrap"},pe={class:"flex justify-between items-center"},_e={key:1,class:"!text-md max-w-[88%] truncate"},me={class:"flex items-center gap-2"},he={key:1,class:"flex items-center gap-1"},fe={key:2,class:"inline-flex items-center gap-1"},ge={class:"flex justify-between items-center"},ye={key:0,class:"flex pt-3 p-1 -space-x-2 overflow-hidden"},De={class:"flex gap-3 items-center"},xe={key:0,class:"inline-flex items-center gap-1"},ke={class:"text-xs"},we={class:"bg-card"},Ce={__name:"Card",props:{card:Object,listName:String,members:Array},emits:["deleteCard"],setup($,{emit:be}){const a=$,z=de(),{isActive:L,cardId:E}=ae(z),F=se(),M={year:"numeric",month:"short",day:"numeric"},O=g(),y=g(!1),e=g(a.card),I=g(null),k=g(null),U=_(()=>new Date(e.value.endDate)-new Date),w=_(()=>U.value/(1e3*60*60)),p=_(()=>new Date>new Date(e.value.endDate)&&!e.value.isComplete),V=_(()=>w.value<24&&w.value>0&&!e.value.isComplete),D=_(()=>w.value<-24&&!e.value.isComplete),N=_(()=>e.value.isComplete?"success":p.value&&D.value?"error":p.value&&!D.value?"error1":!p.value&&V.value?"alert2":""),G=_(()=>e.value.isComplete?"This card is complete":p.value&&D.value?"This card is past due":p.value&&!D.value?"This card is recently overdue":!p.value&&V.value?"This card is due in less than twenty-four hours":"This card is due later");le(()=>{a.card.startDate===null&&(k.value=new Date),a.card.endDate===null&&(I.value=new Date),O.value=[I.value,k.value]});const P=()=>{E.value=e.value.id,L.value=!0},R=()=>{re.post("/card/create",{board:a.card.board,list:a.card.list.id,description:a.card.description,startDate:a.card.startDate,endDate:a.card.endDate,isComplete:a.card.isComplete,labels:a.card.labels.map(i=>i.id),assignees:a.card.assignees.map(i=>i.id),title:a.card.title,cover:a.card.cover,attachments:a.card.attachments},{withCredentials:!0}).then(i=>{ce.emit("update-cards",e.value.board,[a.card.list.id]),F.success("card copied")}).catch(i=>{ie(i)})};return(i,d)=>{const q=o("v-img"),B=o("v-tooltip"),H=o("v-card-title"),J=o("v-chip"),K=o("v-card-text"),Q=o("v-card"),W=o("v-btn"),S=o("v-list-item"),X=o("v-list"),Y=o("v-menu"),Z=o("v-dialog");return t(),r(C,null,[c("div",ue,[(t(),u(Q,{class:"my-1",onClick:P,ripple:!1,key:a.worksapceMembers},{default:s(()=>[e.value.cover?(t(),u(q,{key:0,src:e.value.cover,class:"",cover:"",height:"90"},null,8,["src"])):v("",!0),l(H,null,{default:s(()=>[e.value.labels&&e.value.labels.length>=1?(t(),r("div",ve,[(t(!0),r(C,null,A(e.value.labels,n=>(t(),r("div",{class:"h-2 w-10 rounded",style:ne({backgroundColor:n.color})},null,4))),256))])):v("",!0),c("div",pe,[e.value.title.length>10?(t(),u(B,{key:0,text:e.value.title},{activator:s(({props:n})=>[c("p",b(n,{class:"!text-md max-w-[88%] truncate"}),m(e.value.title),17)]),_:1},8,["text"])):(t(),r("p",_e,m(e.value.title),1))])]),_:1}),(t(),u(K,{key:e.value},{default:s(()=>{var n;return[c("div",me,[e.value.description?(t(),u(h(f),{key:0,icon:"ph:text-align-left",width:"20"})):v("",!0),e.value.comments.length>0?(t(),r("div",he,[l(h(f),{icon:"ph:chat",width:"20"}),T(" "+m(e.value.comments.length),1)])):v("",!0),e.value.checklist?(t(),r("div",fe,[l(h(f),{icon:"ph:list-checks",width:"20"}),c("p",null,m(e.value.checklist.checkedItemsCount)+" / "+m(((n=e.value.checklist.checklistItems)==null?void 0:n.length)||0),1)])):v("",!0)]),c("div",ge,[e.value.assignees.length>0?(t(),r("div",ye,[(t(!0),r(C,null,A(e.value.assignees,x=>(t(),u(oe,{key:x.id,user:x},null,8,["user"]))),128))])):v("",!0),c("div",De,[e.value.attachments.length>0?(t(),r("div",xe,[l(h(f),{icon:"ph:paperclip",width:"20"}),c("p",null,m(e.value.attachments.length),1)])):v("",!0)]),e.value.endDate?(t(),r("div",{key:k.value},[(t(),u(B,{text:G.value,key:N.value},{activator:s(({props:x})=>[(t(),u(J,b({key:p.value||e.value.endDate},x,{size:"small",color:N.value,rounded:"lg"}),{default:s(()=>{var j;return[c("p",ke,m(((j=new Date(e.value.endDate))==null?void 0:j.toLocaleString("en-GB",M))||null),1)]}),_:2},1040,["color"]))]),_:1},8,["text"]))])):v("",!0)])]}),_:1}))]),_:1})),c("div",we,[l(Y,{rounded:"lg"},{activator:s(({props:n})=>[l(W,b(n,{icon:"",size:"35",class:"!absolute right-2 top-2",onClick:()=>{},variant:"text"}),{default:s(()=>[l(h(f),{icon:"ph:dots-three-outline-fill",width:"20"})]),_:2},1040)]),default:s(()=>[l(X,null,{default:s(()=>[l(S,{onClick:R},{prepend:s(()=>[l(h(f),{icon:"ph:copy",width:"20"})]),default:s(()=>[T(" Copy card ")]),_:1}),l(S,{"base-color":"error",onClick:d[0]||(d[0]=n=>y.value=!0)},{prepend:s(()=>[l(h(f),{icon:"ph:trash",width:"20"})]),default:s(()=>[T(" Delete card ")]),_:1})]),_:1})]),_:1})])]),l(Z,{width:"500",modelValue:y.value,"onUpdate:modelValue":d[3]||(d[3]=n=>y.value=n)},{default:s(()=>[l(ee,{title:"Are you sure you want to delete this card?","action-btn-text":"Delete",text:"All progress and information in this card will be deleted",onCancel:d[1]||(d[1]=()=>y.value=!1),onDelete:d[2]||(d[2]=()=>i.$emit("deleteCard",e.value.id))})]),_:1},8,["modelValue"])],64)}}},Be=te(Ce,[["__scopeId","data-v-084087d6"]]);export{Be as default};
