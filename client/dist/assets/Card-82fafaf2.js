import Y from"./DeleteModal-9bd8ae3c.js";import{p as Z,at as ee,v as te,U as ae,r as g,V as p,x as se,c as r,o as t,d as o,f as c,h as u,w as s,i as v,g as l,F as w,j as A,aj as le,m as b,t as f,e as m,I as h,k as T,O as ne,l as re,af as oe,n as ce}from"./index-ed4259d6.js";import{_ as ie}from"./FullDate-8096fc35.js";const de={class:"relative"},ue={key:0,class:"flex gap-2 items-center flex-wrap"},ve={class:"flex justify-between items-center"},_e={key:1,class:"!text-md max-w-[88%] truncate"},pe={class:"flex items-center gap-2"},me={key:1,class:"flex items-center gap-1"},he={key:2,class:"inline-flex items-center gap-1"},fe={class:"flex justify-between items-center"},ge={key:0,class:"flex pt-3 p-1 -space-x-2 overflow-hidden"},ye={class:"flex gap-3 items-center"},De={key:0,class:"inline-flex items-center gap-1"},ke={class:"bg-card"},xe={__name:"Card",props:{card:Object,listName:String,members:Array},emits:["deleteCard"],setup(B,{emit:Ce}){const a=B,S=ee(),{isActive:z,cardId:E}=te(S),F=ae(),L=g(),y=g(!1),e=g(a.card),I=g(null),x=g(null),M=p(()=>new Date(e.value.endDate)-new Date),C=p(()=>M.value/(1e3*60*60)),_=p(()=>new Date>new Date(e.value.endDate)&&!e.value.isComplete),V=p(()=>C.value<24&&C.value>0&&!e.value.isComplete),D=p(()=>C.value<-24&&!e.value.isComplete),j=p(()=>e.value.isComplete?"success":_.value&&D.value?"error":_.value&&!D.value?"error1":!_.value&&V.value?"alert2":""),O=p(()=>e.value.isComplete?"This card is complete":_.value&&D.value?"This card is past due":_.value&&!D.value?"This card is recently overdue":!_.value&&V.value?"This card is due in less than twenty-four hours":"This card is due later");se(()=>{a.card.startDate===null&&(x.value=new Date),a.card.endDate===null&&(I.value=new Date),L.value=[I.value,x.value]});const U=()=>{E.value=e.value.id,z.value=!0},P=()=>{re.post("/card/create",{board:a.card.board,list:a.card.list.id,description:a.card.description,startDate:a.card.startDate,endDate:a.card.endDate,isComplete:a.card.isComplete,labels:a.card.labels.map(i=>i.id),assignees:a.card.assignees.map(i=>i.id),title:a.card.title,cover:a.card.cover,attachments:a.card.attachments},{withCredentials:!0}).then(i=>{oe.emit("update-cards",e.value.board,[a.card.list.id]),F.success("card copied")}).catch(i=>{ce(i)})};return(i,d)=>{const R=r("v-img"),N=r("v-tooltip"),q=r("v-card-title"),G=r("v-chip"),H=r("v-card-text"),J=r("v-card"),K=r("v-btn"),$=r("v-list-item"),Q=r("v-list"),W=r("v-menu"),X=r("v-dialog");return t(),o(w,null,[c("div",de,[(t(),u(J,{class:"my-1",onClick:U,ripple:!1,key:a.worksapceMembers},{default:s(()=>[e.value.cover?(t(),u(R,{key:0,src:e.value.cover,class:"",cover:"",height:"90"},null,8,["src"])):v("",!0),l(q,null,{default:s(()=>[e.value.labels&&e.value.labels.length>=1?(t(),o("div",ue,[(t(!0),o(w,null,A(e.value.labels,n=>(t(),o("div",{class:"h-2 w-10 rounded",style:le({backgroundColor:n.color})},null,4))),256))])):v("",!0),c("div",ve,[e.value.title.length>10?(t(),u(N,{key:0,text:e.value.title},{activator:s(({props:n})=>[c("p",b(n,{class:"!text-md max-w-[88%] truncate"}),f(e.value.title),17)]),_:1},8,["text"])):(t(),o("p",_e,f(e.value.title),1))])]),_:1}),(t(),u(H,{key:e.value},{default:s(()=>{var n;return[c("div",pe,[e.value.description?(t(),u(m(h),{key:0,icon:"ph:text-align-left",width:"20"})):v("",!0),e.value.comments.length>0?(t(),o("div",me,[l(m(h),{icon:"ph:chat",width:"20"}),T(" "+f(e.value.comments.length),1)])):v("",!0),e.value.checklist?(t(),o("div",he,[l(m(h),{icon:"ph:list-checks",width:"20"}),c("p",null,f(e.value.checklist.checkedItemsCount)+" / "+f(((n=e.value.checklist.checklistItems)==null?void 0:n.length)||0),1)])):v("",!0)]),c("div",fe,[e.value.assignees.length>0?(t(),o("div",ge,[(t(!0),o(w,null,A(e.value.assignees,k=>(t(),u(ne,{key:k.id,user:k},null,8,["user"]))),128))])):v("",!0),c("div",ye,[e.value.attachments.length>0?(t(),o("div",De,[l(m(h),{icon:"ph:paperclip",width:"20"}),c("p",null,f(e.value.attachments.length),1)])):v("",!0)]),e.value.endDate?(t(),o("div",{key:x.value},[(t(),u(N,{text:O.value,key:j.value},{activator:s(({props:k})=>[(t(),u(G,b({key:_.value||e.value.endDate},k,{size:"small",color:j.value,rounded:"lg"}),{default:s(()=>[l(ie,{date:e.value.endDate,"include-time":!1},null,8,["date"])]),_:2},1040,["color"]))]),_:1},8,["text"]))])):v("",!0)])]}),_:1}))]),_:1})),c("div",ke,[l(W,{rounded:"lg"},{activator:s(({props:n})=>[l(K,b(n,{icon:"",size:"35",class:"!absolute right-2 top-2",onClick:()=>{},variant:"text"}),{default:s(()=>[l(m(h),{icon:"ph:dots-three-outline-fill",width:"20"})]),_:2},1040)]),default:s(()=>[l(Q,null,{default:s(()=>[l($,{onClick:P},{prepend:s(()=>[l(m(h),{icon:"ph:copy",width:"20"})]),default:s(()=>[T(" Copy card ")]),_:1}),l($,{"base-color":"error",onClick:d[0]||(d[0]=n=>y.value=!0)},{prepend:s(()=>[l(m(h),{icon:"ph:trash",width:"20"})]),default:s(()=>[T(" Delete card ")]),_:1})]),_:1})]),_:1})])]),l(X,{width:"500",modelValue:y.value,"onUpdate:modelValue":d[3]||(d[3]=n=>y.value=n)},{default:s(()=>[l(Y,{title:"Are you sure you want to delete this card?","action-btn-text":"Delete",text:"All progress and information in this card will be deleted",onCancel:d[1]||(d[1]=()=>y.value=!1),onDelete:d[2]||(d[2]=()=>i.$emit("deleteCard",e.value.id))})]),_:1},8,["modelValue"])],64)}}},Ie=Z(xe,[["__scopeId","data-v-f32ef858"]]);export{Ie as default};
