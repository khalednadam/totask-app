import{r as C,M as P,P as V,aC as B,c as D,e as l,o as r,d as g,j as x,f as U,g as A,F as _,h,w as E,X as R,ax as S,ay as j,aD as F,L as v,ah as k}from"./index-9c0f5041.js";import{t as N}from"./vue-draggable-plus-2ebd141e.js";const $={__name:"DraggableLists",props:{isWorkspacePremium:Boolean},async setup(L){let n,u;const b=S(()=>j(()=>import("./List-f8275f0a.js"),["assets/List-f8275f0a.js","assets/index-9c0f5041.js","assets/index-0c684e0b.css","assets/vue-draggable-plus-2ebd141e.js","assets/List-16e31d10.css"])),d=C(!1),p=P(),w=V(),{lists:a,isLoading:c}=([n,u]=B(()=>F(p.params.boardId)),n=await n,u(),n),m=(o,s)=>{v.put(`/list/${o}`,{position:s},{withCredentials:!0}).then(()=>{k.emit("update-lists",{boardId:p.params.boardId})}).catch(t=>{console.log(t)})},y=o=>{let s=o.newIndex,t=a.value[s-1],e=a.value[s+1],i=a.value[s].position;t&&e?i=(t.position+e.position)/2:t?i=t.position+t.position/2:e&&(i=e.position/2),m(o.item.id,i)},I=o=>{d.value=!0,v.delete(`/list/${o}`,{withCredentials:!0}).then(()=>{w.success("List was deleted"),k.emit("update-lists",{boardId:p.params.boardId})}).catch(s=>{console.log(s)}).finally(()=>{d.value=!1})};return(o,s)=>{const t=D("v-progress-circular");return l(c)?(r(),g(_,{key:0},x(4,e=>U("div",{key:e,class:"px-5"},[A(t,{color:"primary",indeterminate:"disable-shrink",size:"50",width:"5"})])),64)):(r(),h(l(N),{key:1,ref:"el",group:"lists",handle:".header",modelValue:l(a),"onUpdate:modelValue":s[1]||(s[1]=e=>R(a)?a.value=e:null),animation:150,ghostClass:"ghost",class:"flex flex-shrink h-[70%] max-h-[70%] justify-between mx-3 gap-3 mb-3",scroll:"",scrollSensitivity:300,onUpdate:y,bubbleScroll:""},{default:E(()=>[(r(!0),g(_,null,x(l(a),(e,f)=>(r(),h(l(b),{key:e.id,"is-workspace-premium":L.isWorkspacePremium,"is-delete-loading":d.value,"is-list-loading":l(c),id:e.id.toString(),list:e,onDeleteList:s[0]||(s[0]=i=>I(i)),index:f,onUpdateIndex:i=>m(e.id,i)},null,8,["is-workspace-premium","is-delete-loading","is-list-loading","id","list","index","onUpdateIndex"]))),128))]),_:1},8,["modelValue"]))}}};export{$ as default};
