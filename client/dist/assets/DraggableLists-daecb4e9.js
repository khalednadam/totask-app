import{l as I,J as C,M as V,aC as D,r as U,b as l,o as r,c as _,j as g,f as B,d as A,F as x,h,w as E,W as P,ax as R,ay as S,aD as j,I as v,ag as L}from"./index-295b0a03.js";import{t as F}from"./vue-draggable-plus-8c748a68.js";const z={__name:"DraggableLists",async setup(N){let n,p;const y=R(()=>S(()=>import("./List-c7023747.js"),["assets/List-c7023747.js","assets/index-295b0a03.js","assets/index-142f3828.css","assets/vue-draggable-plus-8c748a68.js","assets/List-8fd8eb25.css"])),d=I(!1),u=C(),b=V(),{lists:i,isLoading:c}=([n,p]=D(()=>j(u.params.boardId)),n=await n,p(),n),m=(o,t)=>{v.put(`/list/${o}`,{position:t},{withCredentials:!0}).then(()=>{L.emit("update-lists",u.params.boardId)}).catch(s=>{console.log(s)})},k=o=>{let t=o.newIndex,s=i.value[t-1],e=i.value[t+1],a=i.value[t].position;s&&e?a=(s.position+e.position)/2:s?a=s.position+s.position/2:e&&(a=e.position/2),m(o.item.id,a)},w=o=>{d.value=!0,v.delete(`/list/${o}`,{withCredentials:!0}).then(()=>{b.success("List was deleted"),L.emit("update-lists",u.params.boardId)}).catch(t=>{console.log(t)}).finally(()=>{d.value=!1})};return(o,t)=>{const s=U("v-progress-circular");return l(c)?(r(),_(x,{key:0},g(4,e=>B("div",{key:e,class:"px-5"},[A(s,{color:"primary",indeterminate:"disable-shrink",size:"50",width:"5"})])),64)):(r(),h(l(F),{key:1,ref:"el",group:"lists",handle:".header",modelValue:l(i),"onUpdate:modelValue":t[1]||(t[1]=e=>P(i)?i.value=e:null),animation:150,ghostClass:"ghost",class:"flex flex-shrink h-[70%] max-h-[70%] justify-between mx-3 gap-3 mb-3",scroll:"",scrollSensitivity:300,onUpdate:k,bubbleScroll:""},{default:E(()=>[(r(!0),_(x,null,g(l(i),(e,f)=>(r(),h(l(y),{key:e.id,"is-delete-loading":d.value,"is-list-loading":l(c),id:e.id.toString(),list:e,onDeleteList:t[0]||(t[0]=a=>w(a)),index:f,onUpdateIndex:a=>m(e.id,a)},null,8,["is-delete-loading","is-list-loading","id","list","index","onUpdateIndex"]))),128))]),_:1},8,["modelValue"]))}}};export{z as default};
