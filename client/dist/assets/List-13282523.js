import{_ as ne,ac as re,L as ue,k as m,aI as ce,a7 as pe,A as ve,r as f,av as me,o as n,h as _,w as a,d as s,O,f as C,c as x,t as fe,aq as R,b as c,M as b,i as D,e as I,F as M,j as P,V as _e,Q as K,ax as q,ay as F,H as N,ag as w,p as xe,q as ye}from"./index-4a173b8d.js";import{t as ge}from"./vue-draggable-plus-478adf13.js";const be=p=>(xe("data-v-d9ebde66"),p=p(),ye(),p),we={class:"flex justify-between items-center"},Ce={key:1,class:"w-full"},he={class:"overflow-y-auto px-2"},ke={key:0},Ve={class:"px-2 block z-50 mb-2"},Le={class:"px-2"},Ae=be(()=>C("div",null,[C("p",{class:"text-start text-md"},"Add a card")],-1)),De={class:"gap-2 flex"},Ne={__name:"List",props:{list:Object,index:Number,members:Array,isListLoading:Boolean},emits:["deleteList","updateIndex"],setup(p,{emit:Ie}){var U;const H=q(()=>F(()=>import("./DeleteModal-d04cde94.js"),["assets/DeleteModal-d04cde94.js","assets/index-4a173b8d.js","assets/index-816e65fa.css"])),Q=q(()=>F(()=>import("./Card-403aeea1.js"),["assets/Card-403aeea1.js","assets/index-4a173b8d.js","assets/index-816e65fa.css","assets/DeleteModal-d04cde94.js","assets/Board-58560e89.js","assets/favoriteBoards-4ea4fd2c.js","assets/Board-a08b104e.css","assets/Card-5f916aa3.css"])),r=p,G=re(),S=ue(),J=m(null),E=m((U=r.list)==null?void 0:U.name),h=m("");m(null);const k=m(!1),V=m(!1),{cards:v,isLoading:$}=ce(r.list.id,r.list.board),y=m(!1),L=m("");pe(G);const A=m(!1),W=t=>{k.value=!0,h.value=t},X=()=>{k.value=!1,B(),h.value=""},z=()=>{A.value=!0,N.post("/card/create",{board:r.list.board,list:r.list.id,title:L.value},{withCredentials:!0}).then(t=>{w.emit("update-cards",r.list.board,[r.list.id]),L.value="",v.value.push(t.data),S.success("card added")}).catch(t=>{console.log(t)}).finally(()=>{A.value=!1})},Y=t=>{N.delete(`/card/${t}`,{withCredentials:!0}).then(()=>{w.emit("update-cards",r.list.board,[r.list.id]),S.success("card was deleted"),w.emit("delete-card",t)}).catch(e=>{console.log(e)})},B=()=>{N.put(`/list/${r.list.id}`,{name:h.value},{withCredentials:!0}).then(t=>{E.value=t.data.name,w.emit("update-lists",t.data.board)}).catch(t=>{console.log(t)})},T=(t,e,o,l)=>{N.put(`/card/${t}`,{position:l,list:e},{params:{sortBy:"position:asc"},withCredentials:!0}).then(()=>{w.emit("update-cards",r.list.board,[e,o]),w.emit("update-card",t)}).catch(i=>{console.log(i)})},Z=t=>{let e=t.newIndex,o=v.value[e-1],l=v.value[e+1],i=v.value[e],u=(i==null?void 0:i.position)||1024;o&&l?u=(o.position+l.position)/2:o?u=o.position+o.position/2:l?u=l.position/2:u=1024,T(i.id,r.list.id,i.list.id,u)},ee=t=>{let e=t.newIndex,o=v.value[e-1],l=v.value[e+1],i=v.value[e],u=(i==null?void 0:i.position)||1024;o&&l?u=(o.position+l.position)/2:o?u=o.position+o.position/2:l?u=l.position/2:u=1024,T(i.id,r.list.id,i.list.id,u)},te=m(1);return ve(v,()=>{te.value=1}),(t,e)=>{const o=f("v-text-field"),l=f("v-btn"),i=f("v-list-item"),u=f("v-list"),se=f("v-menu"),le=f("v-card-title"),ae=f("v-tooltip"),oe=f("v-skeleton-loader"),ie=f("v-dialog"),de=f("v-card"),j=me("click-outside");return n(),_(de,{rounded:"lg",color:"list",class:"w-[272px] mt-3 h-max max-h-max mb-5",id:p.list.id.toString()},{default:a(()=>[s(ae,{text:p.list.name},{activator:a(({props:d})=>[s(le,O(d,{class:"flex sticky z-20 flex-row items-center justify-between header"}),{default:a(()=>[C("div",we,[k.value?R((n(),x("div",Ce,[s(o,{class:"text-2xl input",modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=g=>h.value=g),"hide-details":"",autofocus:""},null,8,["modelValue"])])),[[j,X]]):(n(),x("div",{key:0,onClick:e[0]||(e[0]=()=>W(E.value)),class:"w-max max-w-[88%] truncate cursor-pointer text-xl py-2 px-2 m-[0.5px]"},fe(p.list.name),1)),s(se,{rounded:"lg"},{activator:a(({props:g})=>[k.value?D("",!0):(n(),_(l,O({key:0,icon:"",variant:"text",size:"30",class:"bg-blue-200"},g),{default:a(()=>[s(c(b),{icon:"ph:dots-three-outline-fill"})]),_:2},1040))]),default:a(()=>[s(u,{rounded:"lg"},{default:a(()=>[s(i,{onClick:e[2]||(e[2]=()=>y.value=!0),density:"compact",rounded:!1},{prepend:a(()=>[s(c(b),{icon:"ph:plus-circle",width:"25"})]),default:a(()=>[I(" Add card ")]),_:1}),s(i,{onClick:e[3]||(e[3]=g=>V.value=!0),"base-color":"error",density:"compact",rounded:!1},{prepend:a(()=>[s(c(b),{icon:"ph:trash",width:"25"})]),default:a(()=>[I(" Delete this list ")]),_:1})]),_:1})]),_:2},1024),k.value?(n(),_(l,{key:2,icon:"",variant:"tonal",color:"primary",size:"35",class:"mx-1",onClick:e[4]||(e[4]=()=>B(p.list.id))},{default:a(()=>[s(c(b),{icon:"ph:check"})]),_:1})):D("",!0)])]),_:2},1040)]),_:1},8,["text"]),C("div",he,[c($)||p.isListLoading?(n(),x("div",ke,[(n(!0),x(M,null,P(Math.floor(Math.random()*3)+1,d=>(n(),_(oe,{key:d,class:"my-3",type:"card-avatar"}))),128))])):D("",!0),c($)?D("",!0):(n(),_(c(ge),{key:1,ref_key:"el",ref:J,group:"cards",class:"space-y-3",modelValue:c(v),"onUpdate:modelValue":e[6]||(e[6]=d=>_e(v)?v.value=d:null),animation:150,dragClass:"drag",ghostClass:"ghost",onUpdate:Z,scroll:"",scrollSensitivity:300,bubbleScroll:"",onAdd:ee},{default:a(()=>[(n(!0),x(M,null,P(c(v),d=>(n(),_(c(Q),{key:d.id,listName:p.list.name,card:d,onDeleteCard:e[5]||(e[5]=g=>Y(g))},null,8,["listName","card"]))),128))]),_:1},8,["modelValue"]))]),R((n(),x("div",Ve,[y.value?(n(),x("div",{key:1,class:"flex flex-col gap-2 px-1 pt-2 pb-2",onKeypress:e[11]||(e[11]=K(d=>z(),["enter"])),onKeydown:e[12]||(e[12]=K(d=>y.value=!1,["esc"]))},[s(o,{"single-line":"",autofocus:"",modelValue:L.value,"onUpdate:modelValue":e[8]||(e[8]=d=>L.value=d),placeholder:"Enter a title for this card",rows:"2","no-resize":"","hide-details":""},null,8,["modelValue"]),C("div",De,[s(l,{color:"primary",loading:A.value,disabled:A.value,onClick:e[9]||(e[9]=()=>z())},{default:a(()=>[I(" Add ")]),_:1},8,["loading","disabled"]),s(l,{variant:"text",icon:"",size:"35",onClick:e[10]||(e[10]=()=>y.value=!1)},{default:a(()=>[s(c(b),{icon:"ph:x",width:"25"})]),_:1})])],32)):(n(),_(l,{key:0,class:"w-full my-1 flex justify-start p-1",height:"40",variant:"text",onClick:e[7]||(e[7]=()=>y.value=!0)},{default:a(()=>[C("div",Le,[s(c(b),{icon:"ph:plus",width:"20"})]),Ae]),_:1}))])),[[j,()=>y.value=!1]]),s(ie,{width:"500",modelValue:V.value,"onUpdate:modelValue":e[15]||(e[15]=d=>V.value=d)},{default:a(()=>[s(c(H),{title:"Are you sure you want to delete this list?",text:"All cards in this list will be deleted","action-btn-text":"Delete",onCancel:e[13]||(e[13]=()=>V.value=!1),onDelete:e[14]||(e[14]=()=>t.$emit("deleteList",p.list.id))})]),_:1},8,["modelValue"])]),_:1},8,["id"])}}},$e=ne(Ne,[["__scopeId","data-v-d9ebde66"]]);export{$e as default};
