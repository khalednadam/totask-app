import{p as ge,ad as ye,T as Ce,r as x,aL as be,s as ke,G as we,c as _,ax as Le,o as a,h,w as o,g as i,m as W,f,e as v,I as C,d as g,t as Ve,ar as G,i as I,F as N,j as S,ag as Z,k as $,Z as De,V as q,az as H,aA as J,l as b,ai as y,n as k,y as Ae,z as Ee}from"./index-25aad1f4.js";import{t as Be}from"./vue-draggable-plus-1a9124e4.js";const T=r=>(Ae("data-v-a0935614"),r=r(),Ee(),r),Ie={class:""},Ne={class:"flex items-center cursor-grab"},Se={key:1,class:"w-full"},ze=T(()=>f("p",{class:"mb-2"},"Change list color",-1)),Fe={class:"flex gap-2"},$e={class:"flex mt-2 gap-2"},Te={class:"overflow-hidden flex-col flex max-h-[70vh]"},Pe={class:"overflow-y-auto px-2 flex-1 max-h-full"},Re={key:0},Ue=T(()=>f("p",null,null,-1)),Oe={class:"px-2 z-50 mb-2"},je={class:"px-2"},Ke=T(()=>f("div",null,[f("p",{class:"text-start text-md"},"Add a card")],-1)),Me={class:"gap-2 flex"},We={__name:"List",props:{list:Object,index:Number,members:Array,isListLoading:Boolean,isDeleteLoading:Boolean,isWorkspacePremium:Boolean},emits:["deleteList","updateIndex"],setup(r,{emit:Ge}){var K;const Q=H(()=>J(()=>import("./DeleteModal-ad90e414.js"),["assets/DeleteModal-ad90e414.js","assets/index-25aad1f4.js","assets/index-90ed9cbc.css"])),X=H(()=>J(()=>import("./Card-3e508a11.js"),["assets/Card-3e508a11.js","assets/DeleteModal-ad90e414.js","assets/index-25aad1f4.js","assets/index-90ed9cbc.css","assets/Board-51b83cf2.js","assets/favoriteBoards-6f0114db.js","assets/Board-a62fed36.css","assets/Card-13146561.css"])),n=r,Y=ye(),P=Ce(),ee=x(null),z=x((K=n.list)==null?void 0:K.name),w=x(""),L=x(!1),D=x(!1),{cards:u,isLoading:R}=be(n.list.id,n.list.board),V=x(!1),A=x(""),{searchWord:te,searchAssignees:le,searchLabels:se,searchDate:ae}=ke(Y),E=x(!1),oe=t=>{L.value=!0,w.value=t},U=["#4BCE97","#F5CD47","#FEA362","#9F8FEF","#6CC3E0","#94C748","#E774BB","#579DFF"],ie=()=>{L.value=!1,de(),w.value=""},O=()=>{E.value=!0,b.post("/card/create",{board:n.list.board,list:n.list.id,title:A.value},{withCredentials:!0}).then(t=>{y.emit("update-cards",n.list.board,[n.list.id]),A.value="",u.value.push(t.data),P.success("card added")}).catch(t=>{k(t)}).finally(()=>{E.value=!1})},ne=t=>{b.delete(`/card/${t}`,{withCredentials:!0}).then(()=>{y.emit("update-cards",n.list.board,[n.list.id]),P.success("card was deleted"),y.emit("delete-card",t)}).catch(e=>{k(e)})},de=()=>{b.put(`/list/${n.list.id}`,{name:w.value}).then(t=>{z.value=t.data.name,y.emit("update-lists",{boardId:t.data.board,results:t.data})}).catch(t=>{k(t)})},j=(t,e,s,l)=>{b.put(`/card/${t}`,{position:l,list:e},{params:{sortBy:"position:asc"},withCredentials:!0}).then(()=>{y.emit("update-cards",n.list.board,[e,s]),y.emit("update-card",t)}).catch(d=>{k(d)})},re=t=>{let e=t.newIndex,s=u.value[e-1],l=u.value[e+1],d=u.value[e],p=(d==null?void 0:d.position)||1024;s&&l?p=(s.position+l.position)/2:s?p=s.position+s.position/2:l?p=l.position/2:p=1024,j(d.id,n.list.id,d.list.id,p)},ue=t=>{let e=t.newIndex,s=u.value[e-1],l=u.value[e+1],d=u.value[e],p=(d==null?void 0:d.position)||1024;s&&l?p=(s.position+l.position)/2:s?p=s.position+s.position/2:l?p=l.position/2:p=1024,j(d.id,n.list.id,d.list.id,p)},B=x(1),ce=({done:t})=>{B.value++;const e=x([]);b.get(`/card/cardsOf/${n.list.id}`,{withCredentials:!0,params:{page:B.value,sortBy:"position:asc",limit:5,title:te.value||" ",assignees:le.value||"",labels:se.value||"",date:ae.value||"",board:n.list.board}}).then(s=>{e.value=s.data.results,s.data.results.length>0?(e.value.map(l=>u.value.push(l)),B.value++,t("ok")):t("empty")}).catch(s=>{k(s)})},F=t=>{b.put(`/list/${n.list.id}`,{color:t}).then(e=>{z.value=e.data.name,y.emit("update-lists",{boardId:e.data.board,results:e.data})}).catch(e=>{k(e)})};return we(u,()=>{B.value=1}),(t,e)=>{const s=_("v-text-field"),l=_("v-btn"),d=_("v-list-item"),p=_("v-list"),ve=_("v-menu"),pe=_("v-card-title"),me=_("v-tooltip"),fe=_("v-skeleton-loader"),_e=_("v-infinite-scroll"),xe=_("v-dialog"),he=_("v-card"),M=Le("click-outside");return a(),h(he,{variant:"elevated",rounded:"lg",color:r.list.color||"list",class:"w-[272px] flex-1 flex h-max overflow-y-hidden",id:r.list.id.toString()},{default:o(()=>[i(me,{text:r.list.name},{activator:o(({props:c})=>[i(pe,W(c,{class:"flex sticky z-20 flex-row items-center justify-between header"}),{default:o(()=>[f("div",Ie,[f("div",Ne,[i(v(C),{icon:"ph:dots-six-vertical-bold",class:"opacity-50 mr-1",width:"30"}),L.value?G((a(),g("div",Se,[i(s,{class:"text-2xl input",modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=m=>w.value=m),"hide-details":"",autofocus:""},null,8,["modelValue"])])),[[M,ie]]):(a(),g("div",{key:0,onClick:e[0]||(e[0]=()=>oe(z.value)),class:"w-full max-w-[90%] truncate items-center cursor-pointer text-xl py-2 pr-2 m-[0.5px]"},Ve(r.list.name),1)),i(ve,{rounded:"lg"},{activator:o(({props:m})=>[L.value?I("",!0):(a(),h(l,W({key:0,icon:"",variant:"text",size:"30",class:"bg-blue-200"},m),{default:o(()=>[i(v(C),{icon:"ph:dots-three-outline-fill"})]),_:2},1040))]),default:o(()=>[i(p,{rounded:"lg"},{default:o(()=>[r.isWorkspacePremium?(a(),h(d,{key:0,rounded:!1},{default:o(()=>[ze,f("div",Fe,[(a(!0),g(N,null,S(U.slice(0,4),m=>(a(),h(l,{onClick:()=>F(m),flat:"",style:Z({backgroundColor:m}),class:"h-8 cursor-pointer flex w-12 rounded-lg"},null,8,["onClick","style"]))),256))]),f("div",$e,[(a(!0),g(N,null,S(U.slice(4,8),m=>(a(),h(l,{onClick:()=>F(m),flat:"",style:Z({backgroundColor:m}),class:"h-8 cursor-pointer flex w-12 rounded-lg"},null,8,["onClick","style"]))),256))]),i(l,{onClick:e[2]||(e[2]=()=>F(null)),class:"w-full mt-2",variant:"tonal"},{default:o(()=>[$(" Remove list color ")]),_:1})]),_:1})):I("",!0),i(d,{onClick:e[3]||(e[3]=m=>D.value=!0),disabled:r.isDeleteLoading,loading:r.isDeleteLoading,"base-color":"error",density:"compact",rounded:!1},{prepend:o(()=>[i(v(C),{icon:"ph:trash",width:"25"})]),default:o(()=>[$(" Delete this list ")]),_:1},8,["disabled","loading"])]),_:1})]),_:2},1024),L.value?(a(),h(l,{key:2,icon:"",variant:"tonal",color:"primary",size:"35",class:"mx-1"},{default:o(()=>[i(v(C),{icon:"ph:check"})]),_:1})):I("",!0)])])]),_:2},1040)]),_:1},8,["text"]),f("div",Te,[f("div",Pe,[v(R)||r.isListLoading?(a(),g("div",Re,[(a(!0),g(N,null,S(Math.floor(Math.random()*3)+1,c=>(a(),h(fe,{key:c,class:"my-3",type:"card-avatar"}))),128))])):I("",!0),i(_e,{"max-height":"60vh",height:"max",items:v(u),onLoad:ce},{empty:o(()=>[Ue]),default:o(()=>[(a(),h(v(Be),{ref_key:"el",ref:ee,group:"cards",class:"space-y-3 relative",modelValue:v(u),"onUpdate:modelValue":e[5]||(e[5]=c=>De(u)?u.value=c:null),animation:150,dragClass:"drag",ghostClass:"ghost",onUpdate:re,scroll:"",scrollSensitivity:300,bubbleScroll:"",onAdd:ue,key:v(R)},{default:o(()=>[(a(!0),g(N,null,S(v(u),c=>(a(),h(v(X),{key:c.id,listName:r.list.name,card:c,onDeleteCard:e[4]||(e[4]=m=>ne(m))},null,8,["listName","card"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["items"])]),G((a(),g("div",Oe,[V.value?(a(),g("div",{key:1,class:"flex flex-col gap-2 px-1 pt-2 pb-2",onKeypress:e[10]||(e[10]=q(c=>O(),["enter"])),onKeydown:e[11]||(e[11]=q(c=>V.value=!1,["esc"]))},[i(s,{"single-line":"",modelValue:A.value,"onUpdate:modelValue":e[7]||(e[7]=c=>A.value=c),placeholder:"Enter a title for this card",rows:"2","no-resize":"","hide-details":""},null,8,["modelValue"]),f("div",Me,[i(l,{color:"primary",loading:E.value,disabled:E.value,onClick:e[8]||(e[8]=()=>O())},{default:o(()=>[$(" Add ")]),_:1},8,["loading","disabled"]),i(l,{variant:"text",icon:"",size:"35",onClick:e[9]||(e[9]=()=>V.value=!1)},{default:o(()=>[i(v(C),{icon:"ph:x",width:"25"})]),_:1})])],32)):(a(),h(l,{key:0,class:"w-full my-1 flex justify-start p-1",height:"40",variant:"text",onClick:e[6]||(e[6]=()=>V.value=!0)},{default:o(()=>[f("div",je,[i(v(C),{icon:"ph:plus",width:"20"})]),Ke]),_:1}))])),[[M,()=>V.value=!1]])]),i(xe,{width:"500",modelValue:D.value,"onUpdate:modelValue":e[14]||(e[14]=c=>D.value=c)},{default:o(()=>[i(v(Q),{title:"Are you sure you want to delete this list?",text:"All cards in this list will be deleted","action-btn-text":"Delete",onCancel:e[12]||(e[12]=()=>D.value=!1),onDelete:e[13]||(e[13]=()=>t.$emit("deleteList",r.list.id))})]),_:1},8,["modelValue"])]),_:1},8,["color","id"])}}},He=ge(We,[["__scopeId","data-v-a0935614"]]);export{He as default};
