import{p as he,ad as ge,T as Ce,r as _,aL as ye,s as be,G as we,c as x,ax as ke,o as n,h,w as a,g as o,m as W,f,e as v,I as y,d as g,t as Le,ar as G,i as S,F as z,j as F,ag as M,k as $,Z as Ve,V as Z,az as q,aA as H,l as b,ai as C,n as w,y as De,z as Ae}from"./index-c1ce3c0a.js";import{t as Ee}from"./vue-draggable-plus-e4b8cf51.js";const T=r=>(De("data-v-1c1e1311"),r=r(),Ae(),r),Be={class:""},Ie={class:"flex items-center cursor-grab"},Ne={key:1,class:"w-full"},Se=T(()=>f("p",{class:"mb-2"},"Change list color",-1)),ze={class:"flex gap-2"},Fe={class:"flex mt-2 gap-2"},$e={class:"overflow-hidden flex-col flex max-h-[70vh]"},Te={class:"overflow-y-auto px-2 flex-1 max-h-full"},Pe=T(()=>f("p",null,null,-1)),Re={class:"px-2 z-50 mb-2"},Ue={class:"px-2"},Oe=T(()=>f("div",null,[f("p",{class:"text-start text-md"},"Add a card")],-1)),je={class:"gap-2 flex"},Ke={__name:"List",props:{list:Object,index:Number,members:Array,isListLoading:Boolean,isDeleteLoading:Boolean,isWorkspacePremium:Boolean},emits:["deleteList","updateIndex"],setup(r,{emit:We}){var j;const J=q(()=>H(()=>import("./DeleteModal-9c0241d5.js"),["assets/DeleteModal-9c0241d5.js","assets/index-c1ce3c0a.js","assets/index-90ed9cbc.css"])),Q=q(()=>H(()=>import("./Card-cc64bd86.js"),["assets/Card-cc64bd86.js","assets/DeleteModal-9c0241d5.js","assets/index-c1ce3c0a.js","assets/index-90ed9cbc.css","assets/Board-f73c6dc9.js","assets/favoriteBoards-f529210b.js","assets/Board-a62fed36.css","assets/Card-13146561.css"])),i=r,X=ge(),P=Ce(),Y=_(null),I=_((j=i.list)==null?void 0:j.name),k=_(""),L=_(!1),D=_(!1),{cards:u,isLoading:ee}=ye(i.list.id,i.list.board),V=_(!1),A=_(""),{searchWord:te,searchAssignees:le,searchLabels:se,searchDate:ae}=be(X),E=_(!1),oe=t=>{L.value=!0,k.value=t},R=["#4BCE97","#F5CD47","#FEA362","#9F8FEF","#6CC3E0","#94C748","#E774BB","#579DFF"],ie=()=>{L.value=!1,ne(),k.value=""},U=()=>{E.value=!0,b.post("/card/create",{board:i.list.board,list:i.list.id,title:A.value},{withCredentials:!0}).then(t=>{C.emit("update-cards",i.list.board,[i.list.id]),A.value="",u.value.push(t.data),P.success("card added")}).catch(t=>{w(t)}).finally(()=>{E.value=!1})},de=t=>{b.delete(`/card/${t}`,{withCredentials:!0}).then(()=>{C.emit("update-cards",i.list.board,[i.list.id]),P.success("card was deleted"),C.emit("delete-card",t)}).catch(e=>{w(e)})},ne=()=>{b.put(`/list/${i.list.id}`,{name:k.value}).then(t=>{I.value=t.data.name,C.emit("update-lists",{boardId:t.data.board,results:t.data})}).catch(t=>{w(t)})},O=(t,e,s,l)=>{b.put(`/card/${t}`,{position:l,list:e},{params:{sortBy:"position:asc"},withCredentials:!0}).then(()=>{C.emit("update-cards",i.list.board,[e,s]),C.emit("update-card",t)}).catch(d=>{w(d)})},re=t=>{let e=t.newIndex,s=u.value[e-1],l=u.value[e+1],d=u.value[e],c=(d==null?void 0:d.position)||1024;s&&l?c=(s.position+l.position)/2:s?c=s.position+s.position/2:l?c=l.position/2:c=1024,O(d.id,i.list.id,d.list.id,c)},ue=t=>{let e=t.newIndex,s=u.value[e-1],l=u.value[e+1],d=u.value[e],c=(d==null?void 0:d.position)||1024;s&&l?c=(s.position+l.position)/2:s?c=s.position+s.position/2:l?c=l.position/2:c=1024,O(d.id,i.list.id,d.list.id,c)},B=_(1),ce=({done:t})=>{B.value++;const e=_([]);b.get(`/card/cardsOf/${i.list.id}`,{withCredentials:!0,params:{page:B.value,sortBy:"position:asc",limit:5,title:te.value||" ",assignees:le.value||"",labels:se.value||"",date:ae.value||"",board:i.list.board}}).then(s=>{e.value=s.data.results,s.data.results.length>0?(e.value.map(l=>u.value.push(l)),B.value++,t("ok")):t("empty")}).catch(s=>{w(s)})},N=t=>{b.put(`/list/${i.list.id}`,{color:t}).then(e=>{I.value=e.data.name,C.emit("update-lists",{boardId:e.data.board,results:e.data})}).catch(e=>{w(e)})};return we(u,()=>{B.value=1}),(t,e)=>{const s=x("v-text-field"),l=x("v-btn"),d=x("v-list-item"),c=x("v-list"),ve=x("v-menu"),pe=x("v-card-title"),me=x("v-tooltip"),fe=x("v-infinite-scroll"),_e=x("v-dialog"),xe=x("v-card"),K=ke("click-outside");return n(),h(xe,{variant:"elevated",rounded:"lg",color:r.list.color||"list",class:"w-[272px] flex-1 flex h-max overflow-y-hidden",id:r.list.id.toString()},{default:a(()=>[o(me,{text:r.list.name},{activator:a(({props:p})=>[o(pe,W(p,{class:"flex sticky z-20 flex-row items-center justify-between header"}),{default:a(()=>[f("div",Be,[f("div",Ie,[o(v(y),{icon:"ph:dots-six-vertical-bold",class:"opacity-50 mr-1",width:"30"}),L.value?G((n(),g("div",Ne,[o(s,{class:"text-2xl input",modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=m=>k.value=m),"hide-details":"",autofocus:""},null,8,["modelValue"])])),[[K,ie]]):(n(),g("div",{key:0,onClick:e[0]||(e[0]=()=>oe(I.value)),class:"w-full max-w-[90%] truncate items-center cursor-pointer text-xl py-2 pr-2 m-[0.5px]"},Le(r.list.name),1)),o(ve,{rounded:"lg"},{activator:a(({props:m})=>[L.value?S("",!0):(n(),h(l,W({key:0,icon:"",variant:"text",size:"30",class:"bg-blue-200"},m),{default:a(()=>[o(v(y),{icon:"ph:dots-three-outline-fill"})]),_:2},1040))]),default:a(()=>[o(c,{rounded:"lg"},{default:a(()=>[r.isWorkspacePremium?(n(),h(d,{key:0,rounded:!1},{default:a(()=>[Se,f("div",ze,[(n(!0),g(z,null,F(R.slice(0,4),m=>(n(),h(l,{onClick:()=>N(m),flat:"",style:M({backgroundColor:m}),class:"h-8 cursor-pointer flex w-12 rounded-lg"},null,8,["onClick","style"]))),256))]),f("div",Fe,[(n(!0),g(z,null,F(R.slice(4,8),m=>(n(),h(l,{onClick:()=>N(m),flat:"",style:M({backgroundColor:m}),class:"h-8 cursor-pointer flex w-12 rounded-lg"},null,8,["onClick","style"]))),256))]),o(l,{onClick:e[2]||(e[2]=()=>N(null)),class:"w-full mt-2",variant:"tonal"},{default:a(()=>[$(" Remove list color ")]),_:1})]),_:1})):S("",!0),o(d,{onClick:e[3]||(e[3]=m=>D.value=!0),disabled:r.isDeleteLoading,loading:r.isDeleteLoading,"base-color":"error",density:"compact",rounded:!1},{prepend:a(()=>[o(v(y),{icon:"ph:trash",width:"25"})]),default:a(()=>[$(" Delete this list ")]),_:1},8,["disabled","loading"])]),_:1})]),_:2},1024),L.value?(n(),h(l,{key:2,icon:"",variant:"tonal",color:"primary",size:"35",class:"mx-1"},{default:a(()=>[o(v(y),{icon:"ph:check"})]),_:1})):S("",!0)])])]),_:2},1040)]),_:1},8,["text"]),f("div",$e,[f("div",Te,[o(fe,{"max-height":"60vh",height:"max",items:v(u),onLoad:ce},{empty:a(()=>[Pe]),default:a(()=>[(n(),h(v(Ee),{ref_key:"el",ref:Y,group:"cards",class:"space-y-3 relative",modelValue:v(u),"onUpdate:modelValue":e[5]||(e[5]=p=>Ve(u)?u.value=p:null),animation:150,dragClass:"drag",ghostClass:"ghost",onUpdate:re,scroll:"",scrollSensitivity:300,bubbleScroll:"",onAdd:ue,key:v(ee)},{default:a(()=>[(n(!0),g(z,null,F(v(u),p=>(n(),h(v(Q),{key:p.id,listName:r.list.name,card:p,onDeleteCard:e[4]||(e[4]=m=>de(m))},null,8,["listName","card"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["items"])]),G((n(),g("div",Re,[V.value?(n(),g("div",{key:1,class:"flex flex-col gap-2 px-1 pt-2 pb-2",onKeypress:e[10]||(e[10]=Z(p=>U(),["enter"])),onKeydown:e[11]||(e[11]=Z(p=>V.value=!1,["esc"]))},[o(s,{"single-line":"",modelValue:A.value,"onUpdate:modelValue":e[7]||(e[7]=p=>A.value=p),placeholder:"Enter a title for this card",rows:"2","no-resize":"","hide-details":""},null,8,["modelValue"]),f("div",je,[o(l,{color:"primary",loading:E.value,disabled:E.value,onClick:e[8]||(e[8]=()=>U())},{default:a(()=>[$(" Add ")]),_:1},8,["loading","disabled"]),o(l,{variant:"text",icon:"",size:"35",onClick:e[9]||(e[9]=()=>V.value=!1)},{default:a(()=>[o(v(y),{icon:"ph:x",width:"25"})]),_:1})])],32)):(n(),h(l,{key:0,class:"w-full my-1 flex justify-start p-1",height:"40",variant:"text",onClick:e[6]||(e[6]=()=>V.value=!0)},{default:a(()=>[f("div",Ue,[o(v(y),{icon:"ph:plus",width:"20"})]),Oe]),_:1}))])),[[K,()=>V.value=!1]])]),o(_e,{width:"500",modelValue:D.value,"onUpdate:modelValue":e[14]||(e[14]=p=>D.value=p)},{default:a(()=>[o(v(J),{title:"Are you sure you want to delete this list?",text:"All cards in this list will be deleted","action-btn-text":"Delete",onCancel:e[12]||(e[12]=()=>D.value=!1),onDelete:e[13]||(e[13]=()=>t.$emit("deleteList",r.list.id))})]),_:1},8,["modelValue"])]),_:1},8,["color","id"])}}},Ze=he(Ke,[["__scopeId","data-v-1c1e1311"]]);export{Ze as default};
