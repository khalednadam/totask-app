import{l as ne,ac as re,O as ue,r as f,aJ as ce,s as ve,C as pe,c as m,av as me,o as r,h as x,w as a,g as s,Q as O,f as h,d as _,t as fe,aq as R,e as v,I as C,i as A,k as I,F as K,j as P,X as xe,T as M,ax as q,ay as F,K as N,ah as w,q as _e,v as ge}from"./index-f1a2c0d1.js";import{t as ye}from"./vue-draggable-plus-5a13d8eb.js";const Ce=d=>(_e("data-v-e0323949"),d=d(),ge(),d),we={class:"flex justify-between items-center"},he={key:1,class:"w-full"},be={class:"overflow-y-auto px-2"},ke={key:0},Le={class:"px-2 block z-50 mb-2"},Ve={class:"px-2"},De=Ce(()=>h("div",null,[h("p",{class:"text-start text-md"},"Add a card")],-1)),Ae={class:"gap-2 flex"},Ne={__name:"List",props:{list:Object,index:Number,members:Array,isListLoading:Boolean,isDeleteLoading:Boolean},emits:["deleteList","updateIndex"],setup(d,{emit:Ie}){var U;const J=q(()=>F(()=>import("./DeleteModal-0f6b8a79.js"),["assets/DeleteModal-0f6b8a79.js","assets/index-f1a2c0d1.js","assets/index-24eff710.css"])),Q=q(()=>F(()=>import("./Card-e65dd4e0.js"),["assets/Card-e65dd4e0.js","assets/index-f1a2c0d1.js","assets/index-24eff710.css","assets/DeleteModal-0f6b8a79.js","assets/Board-417b46ed.js","assets/favoriteBoards-7ff0a4fc.js","assets/Board-2ba79e1d.css","assets/Card-5f916aa3.css"])),u=d,X=re(),S=ue(),G=f(null),B=f((U=u.list)==null?void 0:U.name),b=f(""),k=f(!1),L=f(!1),{cards:p,isLoading:E}=ce(u.list.id,u.list.board),g=f(!1),V=f("");ve(X);const D=f(!1),H=t=>{k.value=!0,b.value=t},W=()=>{k.value=!1,$(),b.value=""},T=()=>{D.value=!0,N.post("/card/create",{board:u.list.board,list:u.list.id,title:V.value},{withCredentials:!0}).then(t=>{w.emit("update-cards",u.list.board,[u.list.id]),V.value="",p.value.push(t.data),S.success("card added")}).catch(t=>{console.log(t)}).finally(()=>{D.value=!1})},Y=t=>{N.delete(`/card/${t}`,{withCredentials:!0}).then(()=>{w.emit("update-cards",u.list.board,[u.list.id]),S.success("card was deleted"),w.emit("delete-card",t)}).catch(e=>{console.log(e)})},$=()=>{N.put(`/list/${u.list.id}`,{name:b.value},{withCredentials:!0}).then(t=>{B.value=t.data.name,w.emit("update-lists",t.data.board)}).catch(t=>{console.log(t)})},z=(t,e,o,l)=>{N.put(`/card/${t}`,{position:l,list:e},{params:{sortBy:"position:asc"},withCredentials:!0}).then(()=>{w.emit("update-cards",u.list.board,[e,o]),w.emit("update-card",t)}).catch(i=>{console.log(i)})},Z=t=>{let e=t.newIndex,o=p.value[e-1],l=p.value[e+1],i=p.value[e],c=(i==null?void 0:i.position)||1024;o&&l?c=(o.position+l.position)/2:o?c=o.position+o.position/2:l?c=l.position/2:c=1024,z(i.id,u.list.id,i.list.id,c)},ee=t=>{let e=t.newIndex,o=p.value[e-1],l=p.value[e+1],i=p.value[e],c=(i==null?void 0:i.position)||1024;o&&l?c=(o.position+l.position)/2:o?c=o.position+o.position/2:l?c=l.position/2:c=1024,z(i.id,u.list.id,i.list.id,c)},te=f(1);return pe(p,()=>{te.value=1}),(t,e)=>{const o=m("v-text-field"),l=m("v-btn"),i=m("v-list-item"),c=m("v-list"),se=m("v-menu"),le=m("v-card-title"),ae=m("v-tooltip"),oe=m("v-skeleton-loader"),ie=m("v-dialog"),de=m("v-card"),j=me("click-outside");return r(),x(de,{rounded:"lg",color:"list",class:"w-[272px] mt-3 h-max max-h-max mb-5",id:d.list.id.toString()},{default:a(()=>[s(ae,{text:d.list.name},{activator:a(({props:n})=>[s(le,O(n,{class:"flex sticky z-20 flex-row items-center justify-between header"}),{default:a(()=>[h("div",we,[k.value?R((r(),_("div",he,[s(o,{class:"text-2xl input",modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=y=>b.value=y),"hide-details":"",autofocus:""},null,8,["modelValue"])])),[[j,W]]):(r(),_("div",{key:0,onClick:e[0]||(e[0]=()=>H(B.value)),class:"w-max max-w-[88%] truncate cursor-pointer text-xl py-2 px-2 m-[0.5px]"},fe(d.list.name),1)),s(se,{rounded:"lg"},{activator:a(({props:y})=>[k.value?A("",!0):(r(),x(l,O({key:0,icon:"",variant:"text",size:"30",class:"bg-blue-200"},y),{default:a(()=>[s(v(C),{icon:"ph:dots-three-outline-fill"})]),_:2},1040))]),default:a(()=>[s(c,{rounded:"lg"},{default:a(()=>[s(i,{onClick:e[2]||(e[2]=()=>g.value=!0),density:"compact",rounded:!1},{prepend:a(()=>[s(v(C),{icon:"ph:plus-circle",width:"25"})]),default:a(()=>[I(" Add card ")]),_:1}),s(i,{onClick:e[3]||(e[3]=y=>L.value=!0),disabled:d.isDeleteLoading,loading:d.isDeleteLoading,"base-color":"error",density:"compact",rounded:!1},{prepend:a(()=>[s(v(C),{icon:"ph:trash",width:"25"})]),default:a(()=>[I(" Delete this list ")]),_:1},8,["disabled","loading"])]),_:1})]),_:2},1024),k.value?(r(),x(l,{key:2,icon:"",variant:"tonal",color:"primary",size:"35",class:"mx-1",onClick:e[4]||(e[4]=()=>$(d.list.id))},{default:a(()=>[s(v(C),{icon:"ph:check"})]),_:1})):A("",!0)])]),_:2},1040)]),_:1},8,["text"]),h("div",be,[v(E)||d.isListLoading?(r(),_("div",ke,[(r(!0),_(K,null,P(Math.floor(Math.random()*3)+1,n=>(r(),x(oe,{key:n,class:"my-3",type:"card-avatar"}))),128))])):A("",!0),v(E)?A("",!0):(r(),x(v(ye),{key:1,ref_key:"el",ref:G,group:"cards",class:"space-y-3",modelValue:v(p),"onUpdate:modelValue":e[6]||(e[6]=n=>xe(p)?p.value=n:null),animation:150,dragClass:"drag",ghostClass:"ghost",onUpdate:Z,scroll:"",scrollSensitivity:300,bubbleScroll:"",onAdd:ee},{default:a(()=>[(r(!0),_(K,null,P(v(p),n=>(r(),x(v(Q),{key:n.id,listName:d.list.name,card:n,onDeleteCard:e[5]||(e[5]=y=>Y(y))},null,8,["listName","card"]))),128))]),_:1},8,["modelValue"]))]),R((r(),_("div",Le,[g.value?(r(),_("div",{key:1,class:"flex flex-col gap-2 px-1 pt-2 pb-2",onKeypress:e[11]||(e[11]=M(n=>T(),["enter"])),onKeydown:e[12]||(e[12]=M(n=>g.value=!1,["esc"]))},[s(o,{"single-line":"",autofocus:"",modelValue:V.value,"onUpdate:modelValue":e[8]||(e[8]=n=>V.value=n),placeholder:"Enter a title for this card",rows:"2","no-resize":"","hide-details":""},null,8,["modelValue"]),h("div",Ae,[s(l,{color:"primary",loading:D.value,disabled:D.value,onClick:e[9]||(e[9]=()=>T())},{default:a(()=>[I(" Add ")]),_:1},8,["loading","disabled"]),s(l,{variant:"text",icon:"",size:"35",onClick:e[10]||(e[10]=()=>g.value=!1)},{default:a(()=>[s(v(C),{icon:"ph:x",width:"25"})]),_:1})])],32)):(r(),x(l,{key:0,class:"w-full my-1 flex justify-start p-1",height:"40",variant:"text",onClick:e[7]||(e[7]=()=>g.value=!0)},{default:a(()=>[h("div",Ve,[s(v(C),{icon:"ph:plus",width:"20"})]),De]),_:1}))])),[[j,()=>g.value=!1]]),s(ie,{width:"500",modelValue:L.value,"onUpdate:modelValue":e[15]||(e[15]=n=>L.value=n)},{default:a(()=>[s(v(J),{title:"Are you sure you want to delete this list?",text:"All cards in this list will be deleted","action-btn-text":"Delete",onCancel:e[13]||(e[13]=()=>L.value=!1),onDelete:e[14]||(e[14]=()=>t.$emit("deleteList",d.list.id))})]),_:1},8,["modelValue"])]),_:1},8,["id"])}}},Ee=ne(Ne,[["__scopeId","data-v-e0323949"]]);export{Ee as default};
