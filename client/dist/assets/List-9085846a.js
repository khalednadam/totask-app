import{l as ve,ac as pe,P as me,r as f,aJ as fe,s as xe,D as _e,c as x,av as ge,o as s,h as _,w as a,g as o,m as K,f as C,d as g,t as Ce,aq as M,e as v,I as h,i as L,F as B,j as N,af as W,k as S,X as ye,T as q,ax as J,ay as X,L as V,ah as y,v as ke,x as he}from"./index-f2d5e21b.js";import{t as be}from"./vue-draggable-plus-97932933.js";const G=n=>(ke("data-v-d470584e"),n=n(),he(),n),we={class:"flex justify-between items-center"},Le={key:1,class:"w-full"},Ve=G(()=>C("p",{class:"mb-2"}," Change list color ",-1)),De={class:"flex gap-2"},Ae={class:"flex mt-2 gap-2"},Ee={class:"overflow-y-auto px-2"},Be={key:0},Ne={class:"px-2 block z-50 mb-2"},Se={class:"px-2"},Ie=G(()=>C("div",null,[C("p",{class:"text-start text-md"},"Add a card")],-1)),Fe={class:"gap-2 flex"},$e={__name:"List",props:{list:Object,index:Number,members:Array,isListLoading:Boolean,isDeleteLoading:Boolean,isWorkspacePremium:Boolean},emits:["deleteList","updateIndex"],setup(n,{emit:ze}){var j;const H=J(()=>X(()=>import("./DeleteModal-0602a206.js"),["assets/DeleteModal-0602a206.js","assets/index-f2d5e21b.js","assets/index-0c684e0b.css"])),Q=J(()=>X(()=>import("./Card-4198da47.js"),["assets/Card-4198da47.js","assets/index-f2d5e21b.js","assets/index-0c684e0b.css","assets/DeleteModal-0602a206.js","assets/Board-7e8f7c33.js","assets/favoriteBoards-9bf57563.js","assets/Board-dae4602d.css","assets/Card-5f916aa3.css"])),r=n,Y=pe(),$=me(),Z=f(null),I=f((j=r.list)==null?void 0:j.name);f(null);const b=f(""),w=f(!1),D=f(!1),{cards:p,isLoading:z}=fe(r.list.id,r.list.board),k=f(!1),A=f("");xe(Y);const E=f(!1),ee=t=>{w.value=!0,b.value=t},P=["#4BCE97","#F5CD47","#FEA362","#9F8FEF","#6CC3E0","#94C748","#E774BB","#579DFF"],te=()=>{w.value=!1,R(),b.value=""},T=()=>{E.value=!0,V.post("/card/create",{board:r.list.board,list:r.list.id,title:A.value},{withCredentials:!0}).then(t=>{y.emit("update-cards",r.list.board,[r.list.id]),A.value="",p.value.push(t.data),$.success("card added")}).catch(t=>{console.log(t)}).finally(()=>{E.value=!1})},le=t=>{V.delete(`/card/${t}`,{withCredentials:!0}).then(()=>{y.emit("update-cards",r.list.board,[r.list.id]),$.success("card was deleted"),y.emit("delete-card",t)}).catch(e=>{console.log(e)})},R=()=>{V.put(`/list/${r.list.id}`,{name:b.value}).then(t=>{I.value=t.data.name,y.emit("update-lists",t.data.board)}).catch(t=>{console.log(t)})},U=(t,e,d,l)=>{V.put(`/card/${t}`,{position:l,list:e},{params:{sortBy:"position:asc"},withCredentials:!0}).then(()=>{y.emit("update-cards",r.list.board,[e,d]),y.emit("update-card",t)}).catch(i=>{console.log(i)})},se=t=>{let e=t.newIndex,d=p.value[e-1],l=p.value[e+1],i=p.value[e],c=(i==null?void 0:i.position)||1024;d&&l?c=(d.position+l.position)/2:d?c=d.position+d.position/2:l?c=l.position/2:c=1024,U(i.id,r.list.id,i.list.id,c)},ae=t=>{let e=t.newIndex,d=p.value[e-1],l=p.value[e+1],i=p.value[e],c=(i==null?void 0:i.position)||1024;d&&l?c=(d.position+l.position)/2:d?c=d.position+d.position/2:l?c=l.position/2:c=1024,U(i.id,r.list.id,i.list.id,c)},oe=f(1),F=t=>{V.put(`/list/${r.list.id}`,{color:t}).then(e=>{I.value=e.data.name,y.emit("update-lists",e.data.board)}).catch(e=>{console.log(e)})};return _e(p,()=>{oe.value=1}),(t,e)=>{const d=x("v-text-field"),l=x("v-btn"),i=x("v-list-item"),c=x("v-list"),ie=x("v-menu"),ne=x("v-card-title"),de=x("v-tooltip"),re=x("v-skeleton-loader"),ue=x("v-dialog"),ce=x("v-card"),O=ge("click-outside");return s(),_(ce,{variant:"elevated",rounded:"lg",color:n.list.color||"list",class:"w-[272px] mt-3 h-max max-h-max mb-5",id:n.list.id.toString()},{default:a(()=>[o(de,{text:n.list.name},{activator:a(({props:u})=>[o(ne,K(u,{class:"flex sticky z-20 flex-row items-center justify-between header"}),{default:a(()=>[C("div",we,[w.value?M((s(),g("div",Le,[o(d,{class:"text-2xl input",modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=m=>b.value=m),"hide-details":"",autofocus:""},null,8,["modelValue"])])),[[O,te]]):(s(),g("div",{key:0,onClick:e[0]||(e[0]=()=>ee(I.value)),class:"w-max max-w-[88%] truncate cursor-pointer text-xl py-2 px-2 m-[0.5px]"},Ce(n.list.name),1)),o(ie,{rounded:"lg"},{activator:a(({props:m})=>[w.value?L("",!0):(s(),_(l,K({key:0,icon:"",variant:"text",size:"30",class:"bg-blue-200"},m),{default:a(()=>[o(v(h),{icon:"ph:dots-three-outline-fill"})]),_:2},1040))]),default:a(()=>[o(c,{rounded:"lg"},{default:a(()=>[n.isWorkspacePremium?(s(),_(i,{key:0,rounded:!1},{default:a(()=>[Ve,C("div",De,[(s(!0),g(B,null,N(P.slice(0,4),m=>(s(),_(l,{onClick:()=>F(m),flat:"",style:W({backgroundColor:m}),class:"h-8 cursor-pointer flex w-12 rounded-lg"},null,8,["onClick","style"]))),256))]),C("div",Ae,[(s(!0),g(B,null,N(P.slice(4,8),m=>(s(),_(l,{onClick:()=>F(m),flat:"",style:W({backgroundColor:m}),class:"h-8 cursor-pointer flex w-12 rounded-lg"},null,8,["onClick","style"]))),256))]),o(l,{onClick:e[2]||(e[2]=()=>F(null)),class:"w-full mt-2",variant:"tonal"},{default:a(()=>[S(" Remove list color ")]),_:1})]),_:1})):L("",!0),o(i,{onClick:e[3]||(e[3]=()=>k.value=!0),density:"compact",rounded:!1},{prepend:a(()=>[o(v(h),{icon:"ph:plus-circle",width:"25"})]),default:a(()=>[S(" Add card ")]),_:1}),o(i,{onClick:e[4]||(e[4]=m=>D.value=!0),disabled:n.isDeleteLoading,loading:n.isDeleteLoading,"base-color":"error",density:"compact",rounded:!1},{prepend:a(()=>[o(v(h),{icon:"ph:trash",width:"25"})]),default:a(()=>[S(" Delete this list ")]),_:1},8,["disabled","loading"])]),_:1})]),_:2},1024),w.value?(s(),_(l,{key:2,icon:"",variant:"tonal",color:"primary",size:"35",class:"mx-1",onClick:e[5]||(e[5]=()=>R(n.list.id))},{default:a(()=>[o(v(h),{icon:"ph:check"})]),_:1})):L("",!0)])]),_:2},1040)]),_:1},8,["text"]),C("div",Ee,[v(z)||n.isListLoading?(s(),g("div",Be,[(s(!0),g(B,null,N(Math.floor(Math.random()*3)+1,u=>(s(),_(re,{key:u,class:"my-3",type:"card-avatar"}))),128))])):L("",!0),v(z)?L("",!0):(s(),_(v(be),{key:1,ref_key:"el",ref:Z,group:"cards",class:"space-y-3",modelValue:v(p),"onUpdate:modelValue":e[7]||(e[7]=u=>ye(p)?p.value=u:null),animation:150,dragClass:"drag",ghostClass:"ghost",onUpdate:se,scroll:"",scrollSensitivity:300,bubbleScroll:"",onAdd:ae},{default:a(()=>[(s(!0),g(B,null,N(v(p),u=>(s(),_(v(Q),{key:u.id,listName:n.list.name,card:u,onDeleteCard:e[6]||(e[6]=m=>le(m))},null,8,["listName","card"]))),128))]),_:1},8,["modelValue"]))]),M((s(),g("div",Ne,[k.value?(s(),g("div",{key:1,class:"flex flex-col gap-2 px-1 pt-2 pb-2",onKeypress:e[12]||(e[12]=q(u=>T(),["enter"])),onKeydown:e[13]||(e[13]=q(u=>k.value=!1,["esc"]))},[o(d,{"single-line":"",autofocus:"",modelValue:A.value,"onUpdate:modelValue":e[9]||(e[9]=u=>A.value=u),placeholder:"Enter a title for this card",rows:"2","no-resize":"","hide-details":""},null,8,["modelValue"]),C("div",Fe,[o(l,{color:"primary",loading:E.value,disabled:E.value,onClick:e[10]||(e[10]=()=>T())},{default:a(()=>[S(" Add ")]),_:1},8,["loading","disabled"]),o(l,{variant:"text",icon:"",size:"35",onClick:e[11]||(e[11]=()=>k.value=!1)},{default:a(()=>[o(v(h),{icon:"ph:x",width:"25"})]),_:1})])],32)):(s(),_(l,{key:0,class:"w-full my-1 flex justify-start p-1",height:"40",variant:"text",onClick:e[8]||(e[8]=()=>k.value=!0)},{default:a(()=>[C("div",Se,[o(v(h),{icon:"ph:plus",width:"20"})]),Ie]),_:1}))])),[[O,()=>k.value=!1]]),o(ue,{width:"500",modelValue:D.value,"onUpdate:modelValue":e[16]||(e[16]=u=>D.value=u)},{default:a(()=>[o(v(H),{title:"Are you sure you want to delete this list?",text:"All cards in this list will be deleted","action-btn-text":"Delete",onCancel:e[14]||(e[14]=()=>D.value=!1),onDelete:e[15]||(e[15]=()=>t.$emit("deleteList",n.list.id))})]),_:1},8,["modelValue"])]),_:1},8,["color","id"])}}},Re=ve($e,[["__scopeId","data-v-d470584e"]]);export{Re as default};
