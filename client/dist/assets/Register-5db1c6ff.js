import{P as I,u as N,r as w,l as b,U as C,c as h,o as m,d as S,g as t,w as c,f as l,e as a,h as _,I as y,k}from"./index-116dbaf1.js";import{u as E,a as p}from"./vee-validate.esm-1cb4ee8a.js";const j=l("h1",{class:"text-7xl mb-10 text-primary"},"Register",-1),F=l("div",null,[l("p",null,"Name")],-1),L=l("div",null,[l("p",null,"Username")],-1),$=l("div",null,[l("p",null,"Email")],-1),q=l("div",{class:"w-full flex justify-between"},[l("p",null,"Password")],-1),D=l("div",{class:"w-full flex justify-between"},[l("p",null,"Confirm password")],-1),O={class:"underline cursor-pointer"},Q={__name:"Register",setup(T){const P=I(),A=N(),x=[e=>!!e||"Required.",e=>e&&e.length>=8||"Min 8 characters",e=>/\d/.test(e)&&/[a-zA-Z]/.test(e)||"Password must contain at least one letter and one number"],{handleSubmit:U,handleReset:G,isSubmitting:H}=E({validationSchema:{name(e){return(e==null?void 0:e.length)>=2?!0:"Please enter your full name"},username(e){return(e==null?void 0:e.length)>=2&&/^[a-zA-Z0-9](?!.*[._]{2})[a-zA-Z0-9._]{0,28}[a-zA-Z0-9]$/i.test(e)?!0:"Please enter a valid username"},password(e){return(e==null?void 0:e.length)>=2?!0:"Please enter a valid password"},confirmPassword(e){return e===o.value.value||(e==null?void 0:e.length)<2?!0:"Passwords doesn't match"},email(e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/i.test(e)?!0:"Please enter a valid email"}}}),z=w(),i=p("email"),v=p("name"),f=p("username"),o=p("password"),V=p("confirmPassword"),n=w(!1),u=w(!1),g=w(!1),Z=U(async()=>{if(o!==o)return"password not match";g.value=!0,b.post("/auth/register",{name:v.value.value,username:f.value.value,email:i.value.value,password:o.value.value},{headers:{"Access-Control-Allow-Origin":"https://totask-server.onrender.com"}}).then(e=>{b.post("/auth/login",{email:i.value.value,password:o.value.value},{withCredentials:!0}).then(s=>{z.value=s.session,A.getUser(),P.push("/")}).catch(s=>{C(s)})}).catch(e=>{C(e)}).finally(()=>{g.value=!1})});return(e,s)=>{const d=h("v-text-field"),M=h("router-link"),R=h("v-btn"),B=h("v-form");return m(),S("div",null,[j,t(B,{class:"my-auto flex flex-col"},{default:c(()=>[F,t(d,{autofocus:"",modelValue:a(v).value.value,"onUpdate:modelValue":s[0]||(s[0]=r=>a(v).value.value=r),"error-messages":a(v).errorMessage.value},null,8,["modelValue","error-messages"]),L,t(d,{modelValue:a(f).value.value,"onUpdate:modelValue":s[1]||(s[1]=r=>a(f).value.value=r),"error-messages":a(f).errorMessage.value,prefix:"@"},null,8,["modelValue","error-messages"]),$,t(d,{modelValue:a(i).value.value,"onUpdate:modelValue":s[2]||(s[2]=r=>a(i).value.value=r),"error-messages":a(i).errorMessage.value},null,8,["modelValue","error-messages"]),q,t(d,{rules:x,modelValue:a(o).value.value,"onUpdate:modelValue":s[5]||(s[5]=r=>a(o).value.value=r),"error-messages":a(o).errorMessage.value,type:n.value?"text":"password"},{"append-inner":c(()=>[n.value?(m(),_(a(y),{key:0,onClick:s[3]||(s[3]=()=>n.value=!n.value),icon:"ph:eye-closed-bold",width:"30",class:"cursor-pointer"})):(m(),_(a(y),{key:1,onClick:s[4]||(s[4]=()=>n.value=!n.value),icon:"ph:eye-bold",width:"30",class:"cursor-pointer"}))]),_:1},8,["modelValue","error-messages","type"]),D,t(d,{rules:x,modelValue:a(V).value.value,"onUpdate:modelValue":s[8]||(s[8]=r=>a(V).value.value=r),"error-messages":a(V).errorMessage.value,type:u.value?"text":"password"},{"append-inner":c(()=>[u.value?(m(),_(a(y),{key:0,onClick:s[6]||(s[6]=()=>u.value=!u.value),icon:"ph:eye-closed-bold",width:"30",class:"cursor-pointer"})):(m(),_(a(y),{key:1,onClick:s[7]||(s[7]=()=>u.value=!u.value),icon:"ph:eye-bold",width:"30",class:"cursor-pointer"}))]),_:1},8,["modelValue","error-messages","type"]),l("div",null,[l("p",null,[k(" Already have an account? "),l("span",O,[t(M,{to:"/login"},{default:c(()=>[k(" Login ")]),_:1})])])]),t(R,{class:"self-end",onClick:a(Z),variant:"tonal",color:"primary",loading:g.value,disabled:g.value},{default:c(()=>[k(" Register ")]),_:1},8,["onClick","loading","disabled"])]),_:1})])}}};export{Q as default};
