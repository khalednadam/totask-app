import{Z as ce,J as ie,u as me,K as ve,M as pe,l as d,a0 as fe,L as _e,B as H,m as ke,r as u,o as r,c as y,h as f,w as a,d as l,i as g,I as h,f as o,e as c,t as L,P as we,b as w,N as V,a1 as be,a2 as xe,F as Q,j as X,a3 as ye,a4 as ge,a5 as he,g as Ve}from"./index-862bde90.js";import Ce from"./DeleteModal-cd472b29.js";const Ae={class:"flex items-center py-5 space-x-2"},Me=o("h2",{class:"text-2xl py-2"},"Workspace Settings",-1),Be={class:"py-5 space-y-1"},We=o("h3",{class:"text-xl"},"Who can add boards to the workspace?",-1),$e={class:"flex items-center gap-2"},Ue={class:"flex items-center gap-2"},De={class:"py-5"},Te=o("h3",{class:"text-xl"},"workspace admins",-1),Ie={class:"py-5"},Ee=o("h3",{class:"text-xl"},"workspace members",-1),Re={class:"flex justify-between items-center"},Pe=o("h1",{class:"px-5 py-3 text-xl"},"Delete Workspace?",-1),je={class:"font-bold text-lg"},Ne=o("p",null,"Things to know:",-1),Se=o("ul",{class:"decoration-dotted list-disc px-5"},[o("li",{class:"decoration-dotted"}," This is permanent and can't be undone. "),o("li",null," All the data related to this workspace will be permanently deleted ")],-1),ze=o("p",{class:"pt-5 pb-1"},"Enter the workspace name to delete it",-1),Fe={class:"flex justify-between items-center"},Oe=o("h1",{class:"px-5 py-3 text-xl"},"Edit Workspace",-1),Ke={class:"flex justify-end gap-5"},Ze={__name:"WorkspaceSettings",setup(Le){const ee=ce("WORKSPACETYPES"),E=ie(),le=me(),C=ve(),R=pe(),J=d(!1),_=d(E.params.workspaceId),s=d(),A=d(),M=d(),B=d(),W=d(""),b=d(!1),m=d(!1),P=d([]),$=d([]),k=d(!1),Y=d(!1),U=d(s.canMemberAddBoards),D=d(null),v=d(!1),{isUserAdmin:j}=fe(E.params.workspaceId),N=n=>{h.get(`/w/${n}`,{withCredentials:!0}).then(e=>{s.value=e.data}).catch(e=>{console.log(e)})},ae=()=>{W.value===s.value.name&&h.delete(`/w/${_.value.toString()}`,{withCredentials:!0}).then(n=>{console.log("Deleted successfully"),R.success("Deleted successfully"),C.push("/")}).catch(n=>{console.log(n)})},te=async()=>{h.put(`/w/${s.value.id}`,null,{withCredentials:!0,params:{body:{name:A.value,type:B.value,description:M.value}}}).then(async n=>{m.value=!1,s.value=N(_.value)}).catch(n=>{console.log(n)})},Z=n=>{h.put(`/w/changeAccess/${_.value}`,{canMemberAddBoards:n},{withCredentials:!0}).then(e=>{s.value=N(_.value),U.value=e.data.canMemberAddBoards}).catch(e=>{console.log(e)})},se=n=>{v.value=!0,D.value=n},oe=()=>{h.put(`/w/removeUserFrom/${_.value}`,{userEmail:D.value.email},{withCredentials:!0}).then(n=>{$.value=$.value.filter(e=>e.id!==n.data.id),v.value=!1,R.success("User was removed successfully")}).catch(n=>{console.log(n),R.error(n.statusText)})};return _e(()=>{var n;s.value&&(P.value=s.value.admins,$.value=s.value.members.filter(e=>!P.value.some(S=>S.id===e.id)),A.value=s.value.name,B.value=s.value.type,M.value=s.value.description,Y.value=Ve(s==null?void 0:s.value,(n=le.user)==null?void 0:n.id),Y||C.push("/"))}),H(v.value,()=>{v.value||(D.value=null)}),ke(()=>{N(E.params.workspaceId),j.value||C.push("/")}),H(j,()=>{j.value||C.push("/")}),(n,e)=>{const S=u("v-avatar"),i=u("v-btn"),ne=u("v-tooltip"),p=u("v-col"),x=u("v-row"),T=u("v-divider"),z=u("v-list-item"),F=u("v-list"),O=u("v-card"),de=u("v-menu"),I=u("v-dialog"),q=u("v-text-field"),G=u("v-card-text"),ue=u("v-select"),re=u("v-textarea");return s.value?(r(),y("div",{key:n.$route.fullPath},[(r(),f(x,{class:"items-center",key:_.value},{default:a(()=>[l(p,{cols:"6",md:"6"},{default:a(()=>[o("div",Ae,[l(S,{color:"primary",rounded:"lg",size:"large",class:"w-full"},{default:a(()=>[c(L(s.value.name[0].toUpperCase()),1)]),_:1}),o("h2",null,L(s.value.name),1),l(ne,{text:"More info","open-delay":1e3},{activator:a(({props:t})=>[l(i,we({variant:"text"},t,{icon:"",size:"x-small",onClick:e[0]||(e[0]=K=>m.value=!m.value)}),{default:a(()=>[l(w(V),{icon:"ph:pencil-simple-line",width:"20"})]),_:2},1040)]),_:1})])]),_:1}),l(p,{cols:"6",md:"6",class:"justify-end flex"},{default:a(()=>[l(i,{color:"primary",onClick:e[1]||(e[1]=t=>k.value=!k.value)},{default:a(()=>[c(" Add members ")]),_:1})]),_:1})]),_:1})),l(T),(r(),f(x,{key:s.value.canMemberAddBoards},{default:a(()=>[l(p,{cols:"12"},{default:a(()=>[Me,o("div",Be,[We,l(T),l(x,null,{default:a(()=>[l(p,{cols:"12",md:"6"},{default:a(()=>{var t,K;return[o("p",null,[(t=s.value)!=null&&t.canMemberAddBoards?(r(),y("span",{key:U.value,class:"font-bold"}," Members and admins ")):g("",!0),(K=s.value)!=null&&K.canMemberAddBoards?g("",!0):(r(),y("span",{class:"font-bold",key:U.value}," Only admins ")),c(" can add boards to this workspace ")])]}),_:1}),l(p,{cols:"12",md:"6",class:"flex flex-col items-end"},{default:a(()=>[(r(),f(de,{modelValue:J.value,"onUpdate:modelValue":e[4]||(e[4]=t=>J.value=t),key:U.value},{activator:a(({props:t})=>[l(i,be(xe(t)),{default:a(()=>[c("Change")]),_:2},1040)]),default:a(()=>[l(O,null,{default:a(()=>[l(F,null,{default:a(()=>[l(z,{onClick:e[2]||(e[2]=t=>Z(!1)),disabled:s.value.canMemberAddBoards==!1},{default:a(()=>[o("p",$e,[s.value.canMemberAddBoards?g("",!0):(r(),f(w(V),{key:0,icon:"ph:check",width:"20"})),c(" Only admins ")])]),_:1},8,["disabled"]),l(z,{onClick:e[3]||(e[3]=t=>Z(!0)),disabled:s.value.canMemberAddBoards==!0},{default:a(()=>[o("p",Ue,[s.value.canMemberAddBoards?(r(),f(w(V),{key:0,icon:"ph:check",width:"20"})):g("",!0),c(" Members and admins ")])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),o("div",De,[Te,l(T),l(F,{"bg-color":"transparent"},{default:a(()=>[(r(!0),y(Q,null,X(P.value,t=>(r(),f(z,{key:t.id,title:t.name,subtitle:"@"+t.username},{prepend:a(()=>[l(ye,{user:t},null,8,["user"])]),_:2},1032,["title","subtitle"]))),128))]),_:1})]),o("div",Ie,[Ee,l(T),l(F,{"bg-color":"transparent"},{default:a(()=>[(r(!0),y(Q,null,X($.value,t=>(r(),f(ge,{key:t.id,member:t},{default:a(()=>[l(i,{color:"error",onClick:()=>se(t)},{default:a(()=>[c(" Remove from workspace ")]),_:2},1032,["onClick"])]),_:2},1032,["member"]))),128))]),_:1})]),l(i,{variant:"text",color:"error",onClick:e[5]||(e[5]=t=>b.value=!b.value)},{default:a(()=>[c(" Delete this workspace ")]),_:1})]),_:1})]),_:1})),l(I,{modelValue:k.value,"onUpdate:modelValue":e[7]||(e[7]=t=>k.value=t)},{default:a(()=>[l(he,{workspaceInfo:s.value,onToggleModal:e[6]||(e[6]=()=>k.value=!k.value)},null,8,["workspaceInfo"])]),_:1},8,["modelValue"]),l(I,{modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=t=>b.value=t)},{default:a(()=>[l(O,{class:"self-center h-full overflow-hidden",rounded:"lg"},{default:a(()=>[l(x,{class:"max-w-[500px]"},{default:a(()=>[l(p,{cols:"12",lg:"12",class:""},{default:a(()=>[o("div",Re,[Pe,l(i,{onClick:e[8]||(e[8]=()=>b.value=!1),size:"x-small",class:"right-5",icon:"",variant:"text"},{default:a(()=>[l(w(V),{icon:"ph:x",width:"25"})]),_:1})]),l(G,null,{default:a(()=>[o("p",je,' Enter the workspace name "'+L(s.value.name)+'" to delete ',1),Ne,Se,ze,l(q,{density:"compact",modelValue:W.value,"onUpdate:modelValue":e[9]||(e[9]=t=>W.value=t)},null,8,["modelValue"]),l(i,{class:"w-full",color:"error",disabled:W.value!==s.value.name,variant:"outlined",onClick:ae},{default:a(()=>[c("delete")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(I,{modelValue:m.value,"onUpdate:modelValue":e[17]||(e[17]=t=>m.value=t),class:"md:w-[40vw] w-full"},{default:a(()=>[l(O,{class:"self-center h-full overflow-hidden w-full",rounded:"lg"},{default:a(()=>[l(x,{class:""},{default:a(()=>[l(p,{cols:"12",lg:"12",class:""},{default:a(()=>[o("div",Fe,[Oe,l(i,{onClick:e[11]||(e[11]=()=>m.value=!1),size:"x-small",class:"right-5",icon:"",variant:"text"},{default:a(()=>[l(w(V),{icon:"ph:x",width:"25"})]),_:1})]),l(G,null,{default:a(()=>[l(q,{label:"workspace name",modelValue:A.value,"onUpdate:modelValue":e[12]||(e[12]=t=>A.value=t),density:"compact"},null,8,["modelValue"]),l(ue,{density:"compact",label:"Workspace type",items:w(ee),modelValue:B.value,"onUpdate:modelValue":e[13]||(e[13]=t=>B.value=t)},null,8,["items","modelValue"]),l(re,{label:"workspace description",modelValue:M.value,"onUpdate:modelValue":e[14]||(e[14]=t=>M.value=t),density:"compact"},null,8,["modelValue"]),o("div",Ke,[l(i,{onClick:e[15]||(e[15]=t=>m.value=!1),variant:"outlined",color:"primary"},{default:a(()=>[c("cancel")]),_:1}),l(i,{variant:"flat",color:"primary",onClick:e[16]||(e[16]=()=>te())},{default:a(()=>[c("save")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(I,{modelValue:v.value,"onUpdate:modelValue":e[20]||(e[20]=t=>v.value=t),width:"500"},{default:a(()=>[l(Ce,{title:"Are you sure you want to remove this member?",text:D.value.name,"action-btn-text":"Remove",onDelete:e[18]||(e[18]=()=>oe()),onCancel:e[19]||(e[19]=()=>v.value=!1)},null,8,["text"])]),_:1},8,["modelValue"])])):g("",!0)}}};export{Ze as default};
