import{a1 as ke,N as we,u as xe,P as be,S as ge,r as u,a3 as ye,Q as he,E as ae,q as Ve,c as d,o as r,d as v,h as x,w as t,g as l,i as b,l as C,f as o,e as m,I as p,t as S,m as Ce,k as c,a4 as Ae,a5 as Me,F as H,j as J,a6 as Ue,b as Be,M as We,_ as $e}from"./index-100ac8fc.js";import Pe from"./DeleteModal-afe996e0.js";const De={class:"flex items-center py-5 space-x-2"},Re={key:0,class:"text-sm"},Te=o("h2",{class:"text-2xl py-2"},"Workspace Settings",-1),Ie={class:"py-5 space-y-1"},Ee=o("h3",{class:"text-xl"},"Who can add boards to the workspace?",-1),je={class:"flex items-center gap-2"},Se={class:"flex items-center gap-2"},qe={class:"py-5"},ze=o("h3",{class:"text-xl"},"workspace admins",-1),Ne={class:"py-5"},Fe=o("h3",{class:"text-xl"},"workspace members",-1),Oe={class:"flex flex-col w-max"},Ge={class:"flex justify-between items-center"},Le=o("h1",{class:"px-5 py-3 text-xl"},"Delete Workspace?",-1),Ke={class:"font-bold text-lg"},Qe=o("p",null,"Things to know:",-1),Ye=o("ul",{class:"decoration-dotted list-disc px-5"},[o("li",{class:"decoration-dotted"}," This is permanent and can't be undone. "),o("li",null," All the data related to this workspace will be permanently deleted ")],-1),He=o("p",{class:"pt-5 pb-1"},"Enter the workspace name to delete it",-1),Je={class:"flex justify-between items-center"},Xe=o("h1",{class:"px-5 py-3 text-xl"},"Edit Workspace",-1),Ze={key:0,class:"flex mx-2 mb-5 justify-between items-center"},el=o("p",null," Premium workspace ",-1),ll={class:"flex justify-end gap-5"},tl=o("p",{class:"text-sm opacity-75 font-bold"}," Get the most out of totask! ",-1),al={class:"list-disc flex flex-col items-start mx-auto w-max justify-end"},ul={__name:"WorkspaceSettings",setup(sl){const se=ke("WORKSPACETYPES"),q=we(),X=xe(),W=be(),z=ge(),Z=u(!1),f=u(q.params.workspaceId),s=u(),$=u(),P=u(),D=u(),R=u(""),A=u(!1),_=u(!1),N=u([]),g=u([]),y=u(!1),ee=u(!1),T=u(s.canMemberAddBoards),I=u(null),k=u(!1),M=u(s.isPremium),{isUserAdmin:F}=ye(q.params.workspaceId),h=u(!1),V=u(!1),oe=["Unlimited boards","Unlimited members","List colors","And more coming soon.."],ne=async()=>{h.value=!0;try{await C.post("/premium-request/create",{workspace:f.value,user:X.user.id}),s.premiumRequested=!0}catch(n){console.log(n)}finally{h.value=!1,V.value=!1}},O=n=>{C.get(`/w/${n}`,{withCredentials:!0}).then(e=>{s.value=e.data}).catch(e=>{console.log(e)})},ue=()=>{R.value===s.value.name&&C.delete(`/w/${f.value.toString()}`,{withCredentials:!0}).then(n=>{console.log("Deleted successfully"),z.success("Deleted successfully"),W.push("/")}).catch(n=>{console.log(n)})},de=async()=>{console.log(M.value),C.put(`/w/${s.value._id.toString()}`,{name:$.value,type:D.value,description:P.value,isPremium:M.value}).then(async n=>{_.value=!1,s.value=O(f.value)}).catch(n=>{console.log(n)})},le=n=>{C.put(`/w/changeAccess/${f.value}`,{canMemberAddBoards:n},{withCredentials:!0}).then(e=>{s.value=O(f.value),T.value=e.data.canMemberAddBoards}).catch(e=>{console.log(e)})},ie=n=>{k.value=!0,I.value=n},re=()=>{C.put(`/w/removeUserFrom/${f.value}`,{userEmail:I.value.email},{withCredentials:!0}).then(n=>{g.value=g.value.filter(e=>e.id!==n.data.id),k.value=!1,z.success("User was removed successfully")}).catch(n=>{console.log(n),z.error(n.statusText)})};return he(()=>{var n;s.value&&(N.value=s.value.admins,g.value=s.value.members.filter(e=>!N.value.some(G=>G.id===e.id)),$.value=s.value.name,D.value=s.value.type,P.value=s.value.description,ee.value=Be(s==null?void 0:s.value,(n=X.user)==null?void 0:n.id),ee||W.push("/"))}),ae(k.value,()=>{k.value||(I.value=null)}),Ve(()=>{O(q.params.workspaceId),F.value||W.push("/")}),ae(F,()=>{F.value||W.push("/")}),(n,e)=>{const G=d("v-avatar"),i=d("v-btn"),ce=d("v-tooltip"),w=d("v-col"),U=d("v-row"),E=d("v-divider"),L=d("v-list-item"),K=d("v-list"),j=d("v-card"),me=d("v-menu"),B=d("v-dialog"),te=d("v-text-field"),Q=d("v-card-text"),ve=d("v-select"),pe=d("v-textarea"),fe=d("v-img"),_e=d("v-card-title");return s.value?(r(),v("div",{key:n.$route.fullPath},[(r(),x(U,{class:"items-center",key:f.value},{default:t(()=>[l(w,{cols:"6",md:"6"},{default:t(()=>[o("div",De,[l(G,{color:"primary",rounded:"lg",size:"large",class:"w-full"},{default:t(()=>[l(m(p),{icon:"ph:building-office",width:"30"})]),_:1}),o("div",null,[o("h2",null,S(s.value.name),1),s.value.isPremium?(r(),v("p",Re," premium ")):b("",!0)]),l(ce,{text:"More info","open-delay":1e3},{activator:t(({props:a})=>[l(i,Ce({variant:"text"},a,{icon:"",size:"x-small",onClick:e[0]||(e[0]=Y=>_.value=!_.value)}),{default:t(()=>[l(m(p),{icon:"ph:pencil-simple-line",width:"20"})]),_:2},1040)]),_:1})])]),_:1}),l(w,{cols:"6",md:"6",class:"justify-end flex"},{default:t(()=>[l(i,{color:"primary",onClick:e[1]||(e[1]=a=>y.value=!y.value)},{default:t(()=>[c(" Add members ")]),_:1})]),_:1})]),_:1})),l(E),(r(),x(U,{key:s.value.canMemberAddBoards},{default:t(()=>[l(w,{cols:"12"},{default:t(()=>[Te,o("div",Ie,[Ee,l(E),l(U,null,{default:t(()=>[l(w,{cols:"12",md:"6"},{default:t(()=>{var a,Y;return[o("p",null,[(a=s.value)!=null&&a.canMemberAddBoards?(r(),v("span",{key:T.value,class:"font-bold"}," Members and admins ")):b("",!0),(Y=s.value)!=null&&Y.canMemberAddBoards?b("",!0):(r(),v("span",{class:"font-bold",key:T.value}," Only admins ")),c(" can add boards to this workspace ")])]}),_:1}),l(w,{cols:"12",md:"6",class:"flex flex-col items-end"},{default:t(()=>[(r(),x(me,{modelValue:Z.value,"onUpdate:modelValue":e[4]||(e[4]=a=>Z.value=a),key:T.value},{activator:t(({props:a})=>[l(i,Ae(Me(a)),{default:t(()=>[c("Change")]),_:2},1040)]),default:t(()=>[l(j,null,{default:t(()=>[l(K,null,{default:t(()=>[l(L,{onClick:e[2]||(e[2]=a=>le(!1)),disabled:s.value.canMemberAddBoards==!1},{default:t(()=>[o("p",je,[s.value.canMemberAddBoards?b("",!0):(r(),x(m(p),{key:0,icon:"ph:check",width:"20"})),c(" Only admins ")])]),_:1},8,["disabled"]),l(L,{onClick:e[3]||(e[3]=a=>le(!0)),disabled:s.value.canMemberAddBoards==!0},{default:t(()=>[o("p",Se,[s.value.canMemberAddBoards?(r(),x(m(p),{key:0,icon:"ph:check",width:"20"})):b("",!0),c(" Members and admins ")])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),o("div",qe,[ze,l(E),l(K,{"bg-color":"transparent"},{default:t(()=>[(r(!0),v(H,null,J(N.value,a=>(r(),x(L,{key:a.id,title:a.name,subtitle:"@"+a.username},{prepend:t(()=>[l(We,{user:a},null,8,["user"])]),_:2},1032,["title","subtitle"]))),128))]),_:1})]),o("div",Ne,[Fe,l(E),l(K,{"bg-color":"transparent"},{default:t(()=>[(r(!0),v(H,null,J(g.value,a=>(r(),x($e,{key:a.id,member:a},{default:t(()=>[l(i,{color:"error",onClick:()=>ie(a)},{default:t(()=>[c(" Remove from workspace ")]),_:2},1032,["onClick"])]),_:2},1032,["member"]))),128))]),_:1})]),o("div",Oe,[l(i,{variant:"flat",class:"mt-5",color:"primary",loading:h.value,disabled:h.value||s.value.premiumRequested,onClick:e[5]||(e[5]=()=>V.value=!0)},{default:t(()=>[l(m(p),{icon:"ph:crown-simple-fill",width:"20"}),c(" Get premium ")]),_:1},8,["loading","disabled"]),l(i,{variant:"text",class:"mt-5",color:"error",onClick:e[6]||(e[6]=a=>A.value=!A.value)},{default:t(()=>[c(" Delete this workspace ")]),_:1})])]),_:1})]),_:1})),l(B,{modelValue:y.value,"onUpdate:modelValue":e[9]||(e[9]=a=>y.value=a)},{default:t(()=>[l(Ue,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=a=>g.value=a),workspaceInfo:s.value,onToggleModal:e[8]||(e[8]=()=>y.value=!y.value)},null,8,["modelValue","workspaceInfo"])]),_:1},8,["modelValue"]),l(B,{modelValue:A.value,"onUpdate:modelValue":e[12]||(e[12]=a=>A.value=a)},{default:t(()=>[l(j,{class:"self-center h-full overflow-hidden",rounded:"lg"},{default:t(()=>[l(U,{class:"max-w-[500px]"},{default:t(()=>[l(w,{cols:"12",lg:"12",class:""},{default:t(()=>[o("div",Ge,[Le,l(i,{onClick:e[10]||(e[10]=()=>A.value=!1),size:"x-small",class:"right-5",icon:"",variant:"text"},{default:t(()=>[l(m(p),{icon:"ph:x",width:"25"})]),_:1})]),l(Q,null,{default:t(()=>[o("p",Ke,' Enter the workspace name "'+S(s.value.name)+'" to delete ',1),Qe,Ye,He,l(te,{density:"compact",modelValue:R.value,"onUpdate:modelValue":e[11]||(e[11]=a=>R.value=a)},null,8,["modelValue"]),l(i,{class:"w-full",color:"error",disabled:R.value!==s.value.name,variant:"outlined",onClick:ue},{default:t(()=>[c("delete")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:_.value,"onUpdate:modelValue":e[20]||(e[20]=a=>_.value=a),class:"md:w-[40vw] w-full"},{default:t(()=>[l(j,{class:"self-center h-full overflow-hidden w-full",rounded:"lg"},{default:t(()=>[l(U,{class:""},{default:t(()=>[l(w,{cols:"12",lg:"12",class:""},{default:t(()=>[o("div",Je,[Xe,l(i,{onClick:e[13]||(e[13]=()=>_.value=!1),size:"x-small",class:"right-5",icon:"",variant:"text"},{default:t(()=>[l(m(p),{icon:"ph:x",width:"25"})]),_:1})]),l(Q,null,{default:t(()=>[l(te,{label:"workspace name",modelValue:$.value,"onUpdate:modelValue":e[14]||(e[14]=a=>$.value=a),density:"compact"},null,8,["modelValue"]),l(ve,{density:"compact",label:"Workspace type",items:m(se),modelValue:D.value,"onUpdate:modelValue":e[15]||(e[15]=a=>D.value=a)},null,8,["items","modelValue"]),l(pe,{label:"workspace description",modelValue:P.value,"onUpdate:modelValue":e[16]||(e[16]=a=>P.value=a),density:"compact"},null,8,["modelValue"]),s.value.isPremium?(r(),v("div",Ze,[el,l(i,{color:"error",variant:"flat",onClick:e[17]||(e[17]=()=>M.value=!M.value)},{default:t(()=>[c(S(s.value.isPremium&&!M.value?"Remove premium":"Cancel"),1)]),_:1})])):b("",!0),o("div",ll,[l(i,{onClick:e[18]||(e[18]=a=>_.value=!1),variant:"outlined",color:"primary"},{default:t(()=>[c("cancel")]),_:1}),l(i,{variant:"flat",color:"primary",onClick:e[19]||(e[19]=()=>de())},{default:t(()=>[c("save")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:V.value,"onUpdate:modelValue":e[23]||(e[23]=a=>V.value=a),class:"md:max-w-[30vw] w-full"},{default:t(()=>[l(j,null,{default:t(()=>[l(i,{variant:"text",class:"!absolute right-1 top-1 z-50",icon:"",size:"35",onClick:e[21]||(e[21]=()=>V.value=!1)},{default:t(()=>[l(m(p),{icon:"ph:x"})]),_:1}),l(fe,{class:"align-end text-white",height:"120",src:"/premiumbg.png",cover:""}),l(_e,{class:"text-center"},{default:t(()=>[c(" Get totask premium "),tl]),_:1}),l(Q,null,{default:t(()=>[o("ul",al,[(r(),v(H,null,J(oe,a=>o("li",null,S(a),1)),64))]),l(i,{onClick:ne,loading:h.value,disabled:h.value||s.value.premiumRequested,color:"primary",class:"w-full mt-5",flat:""},{default:t(()=>[c(" Request totask premium ")]),_:1},8,["loading","disabled"]),l(i,{color:"primary",class:"w-full",variant:"text",flat:"",onClick:e[22]||(e[22]=()=>V.value=!1)},{default:t(()=>[c(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:k.value,"onUpdate:modelValue":e[26]||(e[26]=a=>k.value=a),width:"500"},{default:t(()=>[l(Pe,{title:"Are you sure you want to remove this member?",text:I.value.name,"action-btn-text":"Remove",onDelete:e[24]||(e[24]=()=>re()),onCancel:e[25]||(e[25]=()=>k.value=!1)},null,8,["text"])]),_:1},8,["modelValue"])])):b("",!0)}}};export{ul as default};
