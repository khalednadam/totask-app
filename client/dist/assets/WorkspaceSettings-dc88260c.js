import{a1 as ye,N as he,u as Ve,P as Ce,S as Ae,r as d,a3 as Me,Q as Ue,E as ne,q as Be,c as i,o as c,d as f,h as _,w as a,g as l,i as k,l as w,f as o,e as m,I as b,t as D,m as We,k as r,a4 as Pe,a5 as Te,F as X,j as Z,a6 as $e,b as De,_ as de}from"./index-95b4c5f3.js";import Re from"./DeleteModal-f320b6cc.js";const Ie={class:"flex items-center py-5 space-x-2"},Ee={key:0,class:"text-sm"},je=o("h2",{class:"text-2xl py-2"},"Workspace Settings",-1),Ne={class:"py-5 space-y-1"},Se=o("h3",{class:"text-xl"},"Who can add boards to the workspace?",-1),qe={class:"flex items-center gap-2"},ze={class:"flex items-center gap-2"},Fe={class:"py-5"},Le=o("h3",{class:"text-xl"},"workspace admins",-1),Oe={class:"flex items-center gap-2"},Ge={class:"py-5"},Ke=o("h3",{class:"text-xl"},"workspace members",-1),Qe={class:"flex items-center gap-2"},Ye={class:"flex flex-col w-max"},He={class:"flex justify-between items-center"},Je=o("h1",{class:"px-5 py-3 text-xl"},"Delete Workspace?",-1),Xe={class:"font-bold text-lg"},Ze=o("p",null,"Things to know:",-1),el=o("ul",{class:"decoration-dotted list-disc px-5"},[o("li",{class:"decoration-dotted"}," This is permanent and can't be undone. "),o("li",null," All the data related to this workspace will be permanently deleted ")],-1),ll=o("p",{class:"pt-5 pb-1"},"Enter the workspace name to delete it",-1),al={class:"flex justify-between items-center"},tl=o("h1",{class:"px-5 py-3 text-xl"},"Edit Workspace",-1),sl={key:0,class:"flex mx-2 mb-5 justify-between items-center"},ol=o("p",null," Premium workspace ",-1),nl={class:"flex justify-end gap-5"},dl=o("p",{class:"text-sm opacity-75 font-bold"}," Get the most out of totask! ",-1),ul={class:"list-disc flex flex-col items-start mx-auto w-max justify-end"},ml={__name:"WorkspaceSettings",setup(rl){const ue=ye("WORKSPACETYPES"),L=he(),O=Ve(),R=Ce(),g=Ae(),ee=d(!1),v=d(L.params.workspaceId),s=d(),I=d(),E=d(),j=d(),N=d(""),U=d(!1),x=d(!1),B=d([]),V=d([]),C=d(!1),le=d(!1),S=d(s.canMemberAddBoards),q=d(null),y=d(!1),W=d(s.isPremium),P=d(!1),p=d(!1),{isUserAdmin:G}=Me(L.params.workspaceId),A=d(!1),M=d(!1),re=["Unlimited boards","Unlimited members","List colors","And more coming soon.."],ie=async()=>{A.value=!0;try{await w.post("/premium-request/create",{workspace:v.value,user:O.user.id}),s.premiumRequested=!0}catch(n){console.log(n)}finally{A.value=!1,M.value=!1}},K=n=>{w.get(`/w/${n}`,{withCredentials:!0}).then(e=>{s.value=e.data}).catch(e=>{console.log(e)})},ce=()=>{N.value===s.value.name&&w.delete(`/w/${v.value.toString()}`,{withCredentials:!0}).then(n=>{console.log("Deleted successfully"),g.success("Deleted successfully"),R.push("/")}).catch(n=>{console.log(n)})},me=async()=>{console.log(W.value),w.put(`/w/${s.value._id.toString()}`,{name:I.value,type:j.value,description:E.value,isPremium:W.value}).then(async n=>{x.value=!1,s.value=K(v.value)}).catch(n=>{console.log(n)})},ae=n=>{w.put(`/w/changeAccess/${v.value}`,{canMemberAddBoards:n},{withCredentials:!0}).then(e=>{s.value=K(v.value),S.value=e.data.canMemberAddBoards}).catch(e=>{console.log(e)})},te=n=>{y.value=!0,q.value=n},ve=()=>{P.value=!0,w.put(`/w/removeUserFrom/${v.value}`,{userEmail:q.value.email},{withCredentials:!0}).then(n=>{V.value=V.value.filter(e=>e.id!==n.data.id),y.value=!1,g.success("User was removed successfully")}).catch(n=>{console.log(n),g.error(n.statusText)}).finally(()=>{P.value=!1})},pe=async n=>{p.value=!0;try{const e=await w.put("/w/promoteMemberToAdmin",{workspaceId:v.value,member:n});g.success("User has been promoted"),B.value.push(e.data)}catch(e){g.error(e)}finally{p.value=!1}},fe=async n=>{p.value=!0;try{const e=await w.put("/w/removeWorkspaceAdmin",{workspaceId:v.value,member:n});g.success("User has been updated")}catch(e){g.error(e)}finally{p.value=!1}};return Ue(()=>{var n;s.value&&(B.value=s.value.admins,V.value=s.value.members.filter(e=>!B.value.some(Q=>Q.id===e.id)),I.value=s.value.name,j.value=s.value.type,E.value=s.value.description,le.value=De(s==null?void 0:s.value,(n=O.user)==null?void 0:n.id),le||R.push("/"))}),ne(y.value,()=>{y.value||(q.value=null)}),Be(()=>{K(L.params.workspaceId),G.value||R.push("/")}),ne(G,()=>{G.value||R.push("/")}),(n,e)=>{const Q=i("v-avatar"),u=i("v-btn"),_e=i("v-tooltip"),h=i("v-col"),T=i("v-row"),z=i("v-divider"),se=i("v-list-item"),Y=i("v-list"),F=i("v-card"),ke=i("v-menu"),$=i("v-dialog"),oe=i("v-text-field"),H=i("v-card-text"),we=i("v-select"),be=i("v-textarea"),ge=i("v-img"),xe=i("v-card-title");return s.value?(c(),f("div",{key:n.$route.fullPath},[(c(),_(T,{class:"items-center",key:v.value},{default:a(()=>[l(h,{cols:"6",md:"6"},{default:a(()=>[o("div",Ie,[l(Q,{color:"primary",rounded:"lg",size:"large",class:"w-full"},{default:a(()=>[l(m(b),{icon:"ph:building-office",width:"30"})]),_:1}),o("div",null,[o("h2",null,D(s.value.name),1),s.value.isPremium?(c(),f("p",Ee," premium ")):k("",!0)]),l(_e,{text:"More info","open-delay":1e3},{activator:a(({props:t})=>[l(u,We({variant:"text"},t,{icon:"",size:"x-small",onClick:e[0]||(e[0]=J=>x.value=!x.value)}),{default:a(()=>[l(m(b),{icon:"ph:pencil-simple-line",width:"20"})]),_:2},1040)]),_:1})])]),_:1}),l(h,{cols:"6",md:"6",class:"justify-end flex"},{default:a(()=>[l(u,{color:"primary",onClick:e[1]||(e[1]=t=>C.value=!C.value)},{default:a(()=>[r(" Add members ")]),_:1})]),_:1})]),_:1})),l(z),(c(),_(T,{key:s.value.canMemberAddBoards},{default:a(()=>[l(h,{cols:"12"},{default:a(()=>[je,o("div",Ne,[Se,l(z),l(T,null,{default:a(()=>[l(h,{cols:"12",md:"6"},{default:a(()=>{var t,J;return[o("p",null,[(t=s.value)!=null&&t.canMemberAddBoards?(c(),f("span",{key:S.value,class:"font-bold"}," Members and admins ")):k("",!0),(J=s.value)!=null&&J.canMemberAddBoards?k("",!0):(c(),f("span",{class:"font-bold",key:S.value}," Only admins ")),r(" can add boards to this workspace ")])]}),_:1}),l(h,{cols:"12",md:"6",class:"flex flex-col items-end"},{default:a(()=>[(c(),_(ke,{modelValue:ee.value,"onUpdate:modelValue":e[4]||(e[4]=t=>ee.value=t),key:S.value},{activator:a(({props:t})=>[l(u,Pe(Te(t)),{default:a(()=>[r("Change")]),_:2},1040)]),default:a(()=>[l(F,null,{default:a(()=>[l(Y,null,{default:a(()=>[l(se,{onClick:e[2]||(e[2]=t=>ae(!1)),disabled:s.value.canMemberAddBoards==!1},{default:a(()=>[o("p",qe,[s.value.canMemberAddBoards?k("",!0):(c(),_(m(b),{key:0,icon:"ph:check",width:"20"})),r(" Only admins ")])]),_:1},8,["disabled"]),l(se,{onClick:e[3]||(e[3]=t=>ae(!0)),disabled:s.value.canMemberAddBoards==!0},{default:a(()=>[o("p",ze,[s.value.canMemberAddBoards?(c(),_(m(b),{key:0,icon:"ph:check",width:"20"})):k("",!0),r(" Members and admins ")])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),o("div",Fe,[Le,l(z),l(Y,{"bg-color":"transparent"},{default:a(()=>[(c(!0),f(X,null,Z(B.value,t=>(c(),_(de,{key:t.id||B.value,member:t},{default:a(()=>[o("div",Oe,[s.value.createdBy!==t.id?(c(),_(u,{key:0,loading:p.value,disabled:p.value,onClick:()=>fe(t.id),variant:"flat",color:"primary"},{default:a(()=>[r(" Normal ")]),_:2},1032,["loading","disabled","onClick"])):k("",!0),l(u,{variant:"flat",color:"error",onClick:()=>te(t),loading:P.value,disabled:P.value},{default:a(()=>[r(D(m(O).user.id===t.id?"Leave":"Remove from workspace"),1)]),_:2},1032,["onClick","loading","disabled"])])]),_:2},1032,["member"]))),128))]),_:1})]),o("div",Ge,[Ke,l(z),l(Y,{"bg-color":"transparent"},{default:a(()=>[(c(!0),f(X,null,Z(V.value,t=>(c(),_(de,{key:t.id,member:t},{default:a(()=>[o("div",Qe,[l(u,{loading:p.value,disabled:p.value,onClick:()=>pe(t.id),variant:"flat",color:"primary"},{default:a(()=>[r(" Promote to admin ")]),_:2},1032,["loading","disabled","onClick"]),l(u,{variant:"flat",color:"error",onClick:()=>te(t)},{default:a(()=>[r(" Remove from workspace ")]),_:2},1032,["onClick"])])]),_:2},1032,["member"]))),128))]),_:1})]),o("div",Ye,[l(u,{variant:"flat",class:"mt-5",color:"primary",loading:A.value,disabled:A.value||s.value.premiumRequested,onClick:e[5]||(e[5]=()=>M.value=!0)},{default:a(()=>[l(m(b),{icon:"ph:crown-simple-fill",width:"20"}),r(" Get premium ")]),_:1},8,["loading","disabled"]),l(u,{variant:"text",class:"mt-5",color:"error",onClick:e[6]||(e[6]=t=>U.value=!U.value)},{default:a(()=>[r(" Delete this workspace ")]),_:1})])]),_:1})]),_:1})),l($,{modelValue:C.value,"onUpdate:modelValue":e[9]||(e[9]=t=>C.value=t)},{default:a(()=>[l($e,{modelValue:V.value,"onUpdate:modelValue":e[7]||(e[7]=t=>V.value=t),workspaceInfo:s.value,onToggleModal:e[8]||(e[8]=()=>C.value=!C.value)},null,8,["modelValue","workspaceInfo"])]),_:1},8,["modelValue"]),l($,{modelValue:U.value,"onUpdate:modelValue":e[12]||(e[12]=t=>U.value=t)},{default:a(()=>[l(F,{class:"self-center h-full overflow-hidden",rounded:"lg"},{default:a(()=>[l(T,{class:"max-w-[500px]"},{default:a(()=>[l(h,{cols:"12",lg:"12",class:""},{default:a(()=>[o("div",He,[Je,l(u,{onClick:e[10]||(e[10]=()=>U.value=!1),size:"x-small",class:"right-5",icon:"",variant:"text"},{default:a(()=>[l(m(b),{icon:"ph:x",width:"25"})]),_:1})]),l(H,null,{default:a(()=>[o("p",Xe,' Enter the workspace name "'+D(s.value.name)+'" to delete ',1),Ze,el,ll,l(oe,{density:"compact",modelValue:N.value,"onUpdate:modelValue":e[11]||(e[11]=t=>N.value=t)},null,8,["modelValue"]),l(u,{class:"w-full",color:"error",disabled:N.value!==s.value.name,variant:"outlined",onClick:ce},{default:a(()=>[r("delete")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l($,{modelValue:x.value,"onUpdate:modelValue":e[20]||(e[20]=t=>x.value=t),class:"md:w-[40vw] w-full"},{default:a(()=>[l(F,{class:"self-center h-full overflow-hidden w-full",rounded:"lg"},{default:a(()=>[l(T,{class:""},{default:a(()=>[l(h,{cols:"12",lg:"12",class:""},{default:a(()=>[o("div",al,[tl,l(u,{onClick:e[13]||(e[13]=()=>x.value=!1),size:"x-small",class:"right-5",icon:"",variant:"text"},{default:a(()=>[l(m(b),{icon:"ph:x",width:"25"})]),_:1})]),l(H,null,{default:a(()=>[l(oe,{label:"workspace name",modelValue:I.value,"onUpdate:modelValue":e[14]||(e[14]=t=>I.value=t),density:"compact"},null,8,["modelValue"]),l(we,{density:"compact",label:"Workspace type",items:m(ue),modelValue:j.value,"onUpdate:modelValue":e[15]||(e[15]=t=>j.value=t)},null,8,["items","modelValue"]),l(be,{label:"workspace description",modelValue:E.value,"onUpdate:modelValue":e[16]||(e[16]=t=>E.value=t),density:"compact"},null,8,["modelValue"]),s.value.isPremium?(c(),f("div",sl,[ol,l(u,{color:"error",variant:"flat",onClick:e[17]||(e[17]=()=>W.value=!W.value)},{default:a(()=>[r(D(s.value.isPremium&&!W.value?"Remove premium":"Cancel"),1)]),_:1})])):k("",!0),o("div",nl,[l(u,{onClick:e[18]||(e[18]=t=>x.value=!1),variant:"outlined",color:"primary"},{default:a(()=>[r("cancel")]),_:1}),l(u,{variant:"flat",color:"primary",onClick:e[19]||(e[19]=()=>me())},{default:a(()=>[r("save")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l($,{modelValue:M.value,"onUpdate:modelValue":e[23]||(e[23]=t=>M.value=t),class:"md:max-w-[30vw] w-full"},{default:a(()=>[l(F,null,{default:a(()=>[l(u,{variant:"text",class:"!absolute right-1 top-1 z-50",icon:"",size:"35",onClick:e[21]||(e[21]=()=>M.value=!1)},{default:a(()=>[l(m(b),{icon:"ph:x"})]),_:1}),l(ge,{class:"align-end text-white",height:"120",src:"/premiumbg.png",cover:""}),l(xe,{class:"text-center"},{default:a(()=>[r(" Get totask premium "),dl]),_:1}),l(H,null,{default:a(()=>[o("ul",ul,[(c(),f(X,null,Z(re,t=>o("li",null,D(t),1)),64))]),l(u,{onClick:ie,loading:A.value,disabled:A.value||s.value.premiumRequested,color:"primary",class:"w-full mt-5",flat:""},{default:a(()=>[r(" Request totask premium ")]),_:1},8,["loading","disabled"]),l(u,{color:"primary",class:"w-full",variant:"text",flat:"",onClick:e[22]||(e[22]=()=>M.value=!1)},{default:a(()=>[r(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l($,{modelValue:y.value,"onUpdate:modelValue":e[26]||(e[26]=t=>y.value=t),width:"500"},{default:a(()=>[l(Re,{title:"Are you sure you want to remove this member?",text:q.value.name,"action-btn-text":"Remove",onDelete:e[24]||(e[24]=()=>ve()),onCancel:e[25]||(e[25]=()=>y.value=!1),"is-loading":P.value},null,8,["text","is-loading"])]),_:1},8,["modelValue"])])):k("",!0)}}};export{ml as default};
